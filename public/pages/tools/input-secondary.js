const firebaseConfig = {
    apiKey: "AIzaSyDn5l50utUfCEBpWEYX_lQO5Ar3OB0WAmc",
    authDomain: "salamom-d3246.firebaseapp.com",
    databaseURL: "https://salamom-d3246-default-rtdb.firebaseio.com",
    projectId: "salamom-d3246",
    storageBucket: "salamom-d3246.appspot.com",
    messagingSenderId: "521352537338",
    appId: "1:521352537338:web:fbccf858c76c4a843d1543"
};
firebase.initializeApp(firebaseConfig);

var user_login_name = localStorage.getItem('setName');
var user_login_subs = localStorage.getItem('setSubs');
var user_login_year = localStorage.getItem('setYear');
var user_month = localStorage.getItem('input_month');
var user_url = localStorage.getItem('user_url');
var user_img = document.getElementById('user_img');
if (user_url) {
    user_img.src = user_url;
}
var get_subs = localStorage.getItem('set_to_get_subs');
//Convert En to KH
var month = '';
var show_month = '';

var table = document.getElementById('show_hearder')
var tbody_data = document.getElementById('show_footer')
if (get_subs) {
    var [s] = get_subs.substring(0, 3).split(" ");
    var [sb] = get_subs.substring(4, 10).split(" ");
}
let grade = '';
let grade_kh = '';
//Grade in EN
if (s == '01A') { grade = '1A' };
if (s == '02A') { grade = '2A' };
if (s == '03A') { grade = '3A' };
if (s == '04A') { grade = '4A' };
if (s == '05A') { grade = '5A' };
if (s == '06A') { grade = '6A' };
if (s == '07A') { grade = '7A' };
if (s == '08A') { grade = '8A' };
if (s == '09A') { grade = '9A' };
if (s == '10A') { grade = '10A' };
if (s == '11A') { grade = '11A' };
if (s == '12A') { grade = '12A' };

if (s == '01B') { grade = '1B' };
if (s == '02B') { grade = '2B' };
if (s == '03B') { grade = '3B' };
if (s == '04B') { grade = '4B' };
if (s == '05B') { grade = '5B' };
if (s == '06B') { grade = '6B' };
if (s == '07B') { grade = '7B' };
if (s == '08B') { grade = '8B' };
if (s == '09B') { grade = '9B' };
if (s == '10B') { grade = '10B' };
if (s == '11B') { grade = '11B' };
if (s == '12B') { grade = '12B' };

if (s == '01C') { grade = '1C' };
if (s == '02C') { grade = '2C' };
if (s == '03C') { grade = '3C' };
if (s == '04C') { grade = '4C' };
if (s == '05C') { grade = '5C' };
if (s == '06C') { grade = '6C' };
if (s == '07C') { grade = '7C' };
if (s == '08C') { grade = '8C' };
if (s == '09C') { grade = '9C' };
if (s == '10C') { grade = '10C' };
if (s == '10C') { grade = '10C' };
if (s == '11C') { grade = '11C' };
if (s == '12C') { grade = '12C' };
//Grade in Kh
if (grade == '1A') { grade_kh = '១ក' };
if (grade == '2A') { grade_kh = '២ក' };
if (grade == '3A') { grade_kh = '៣ក' };
if (grade == '4A') { grade_kh = '៤ក' };
if (grade == '5A') { grade_kh = '៥ក' };
if (grade == '6A') { grade_kh = '៦ក' };
if (grade == '7A') { grade_kh = '៧ក' };
if (grade == '8A') { grade_kh = '៨ក' };
if (grade == '9A') { grade_kh = '៩ក' };
if (grade == '10A') { grade_kh = '១០ក' };
if (grade == '11A') { grade_kh = '១១ក' };
if (grade == '12A') { grade_kh = '១២ក' };

if (grade == '1B') { grade_kh = '១ខ' };
if (grade == '2B') { grade_kh = '២ខ' };
if (grade == '3B') { grade_kh = '៣ខ' };
if (grade == '4B') { grade_kh = '៤ខ' };
if (grade == '5B') { grade_kh = '៥ខ' };
if (grade == '6B') { grade_kh = '៦ខ' };
if (grade == '7B') { grade_kh = '៧ខ' };
if (grade == '8B') { grade_kh = '៨ខ' };
if (grade == '9B') { grade_kh = '៩ខ' };
if (grade == '10B') { grade_kh = '១០ខ' };
if (grade == '10C') { grade_kh = '១០គ' };
if (grade == '11B') { grade_kh = '១១ខ' };
if (grade == '12B') { grade_kh = '១២ខ' };

if (grade == '1C') { grade_kh = '១គ' };
if (grade == '2C') { grade_kh = '២គ' };
if (grade == '3C') { grade_kh = '៣គ' };
if (grade == '4C') { grade_kh = '៤គ' };
if (grade == '5C') { grade_kh = '៥គ' };
if (grade == '6C') { grade_kh = '៦គ' };
if (grade == '7C') { grade_kh = '៧គ' };
if (grade == '8C') { grade_kh = '៨គ' };
if (grade == '9C') { grade_kh = '៩គ' };
if (grade == '10C') { grade_kh = '១០គ' };
if (grade == '11C') { grade_kh = '១១គ' };
if (grade == '12C') { grade_kh = '១២គ' };

document.getElementById('grade_title').innerHTML = grade_kh;
let sub = '';
if (sb == 'PE') { sub = 'កីឡា' }
if (sb == 'E') { sub = 'ភាសាអង់គ្លេស' }
if (sb == 'ICT') { sub = 'កុំព្យូទ័រ' }
if (sb == 'M') { sub = 'គណិតវិទ្យា' }
if (sb == 'C') { sub = 'គីមីវិទ្យា' }
if (sb == 'Ho') { sub = 'គេហៈ' }
if (sb == 'Bio') { sub = 'ជីវៈវិទ្យា' }
if (sb == 'H') { sub = 'ប្រវត្តិវិទ្យា' }
if (sb == 'ES') { sub = 'ផែនដីវិទ្យា' }
if (sb == 'G') { sub = 'ភូមិវិទ្យា' }
if (sb == 'P') { sub = 'រូបវិទ្យា' }
if (sb == 'Ac') { sub = 'សកម្មភាព' }
if (sb == 'Bi') { sub = 'សិក្សាសីលធម៌' }
if (sb == 'Mo') { sub = 'សីលធម៌-ពលរដ្ឋ' }
if (sb == 'Eco') { sub = 'សេដ្ឋកិច្ច' }
if (sb == 'K') { sub = 'ភាសាខ្មែរ' }
if (sb == 'Sci') { sub = 'វិទ្យាសាស្ត្រ' }
if (sb == 'Soc') { sub = 'សិក្សាសង្គម' }
var N0 = '';

export function secondaryInput() {
    // ខែតុលា
    if (user_month == 'October') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_moct = d.val().e_moct;
                        if (!e_moct) { e_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_moct1="${N0}">${e_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct1);
                                    const nextCell = document.querySelector(`[data-e_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct1);
                                    const nextCell = document.querySelector(`[data-e_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct1);
                                    const nextCell = document.querySelector(`[data-e_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_moct = d.val().pe_moct;
                        if (!pe_moct) { pe_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_moct1="${N0}">${pe_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_moct1);
                                    const nextCell = document.querySelector(`[data-pe_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_moct1);
                                    const nextCell = document.querySelector(`[data-pe_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_moct1);
                                    const nextCell = document.querySelector(`[data-pe_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_moct = d.val().mo_moct;
                        if (!mo_moct) { mo_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_moct1="${N0}">${mo_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_moct1);
                                    const nextCell = document.querySelector(`[data-mo_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_moct1);
                                    const nextCell = document.querySelector(`[data-mo_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_moct1);
                                    const nextCell = document.querySelector(`[data-mo_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_moct = d.val().ict_moct;
                        if (!ict_moct) { ict_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_moct1="${N0}">${ict_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_moct1);
                                    const nextCell = document.querySelector(`[data-ict_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_moct1);
                                    const nextCell = document.querySelector(`[data-ict_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_moct1);
                                    const nextCell = document.querySelector(`[data-ict_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_moct = d.val().math_moct;
                        if (!math_moct) { math_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_moct1="${N0}">${math_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_moct1);
                                    const nextCell = document.querySelector(`[data-math_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_moct1);
                                    const nextCell = document.querySelector(`[data-math_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_moct1);
                                    const nextCell = document.querySelector(`[data-math_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_moct = d.val().k_moct;
                        if (!k_moct) { k_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_moct1="${N0}">${k_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_moct1);
                                    const nextCell = document.querySelector(`[data-k_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_moct1);
                                    const nextCell = document.querySelector(`[data-k_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_moct1);
                                    const nextCell = document.querySelector(`[data-k_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_moct = d.val().hist_moct;
                        if (!hist_moct) { hist_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_moct1="${N0}">${hist_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_moct1);
                                    const nextCell = document.querySelector(`[data-hist_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_moct1);
                                    const nextCell = document.querySelector(`[data-hist_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_moct1);
                                    const nextCell = document.querySelector(`[data-hist_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_moct = d.val().earth_moct;
                        if (!earth_moct) { earth_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_moct1="${N0}">${earth_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_moct1);
                                    const nextCell = document.querySelector(`[data-earth_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_moct1);
                                    const nextCell = document.querySelector(`[data-earth_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_moct1);
                                    const nextCell = document.querySelector(`[data-earth_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_moct = d.val().geor_moct;
                        if (!geor_moct) { geor_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_moct1="${N0}">${geor_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_moct1);
                                    const nextCell = document.querySelector(`[data-geor_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_moct1);
                                    const nextCell = document.querySelector(`[data-geor_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_moct1);
                                    const nextCell = document.querySelector(`[data-geor_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_moct = d.val().phy_moct;
                        if (!phy_moct) { phy_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_moct1="${N0}">${phy_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_moct1);
                                    const nextCell = document.querySelector(`[data-phy_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_moct1);
                                    const nextCell = document.querySelector(`[data-phy_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_moct1);
                                    const nextCell = document.querySelector(`[data-phy_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_moct = d.val().chem_moct;
                        if (!chem_moct) { chem_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_moct1="${N0}">${chem_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_moct1);
                                    const nextCell = document.querySelector(`[data-chem_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_moct1);
                                    const nextCell = document.querySelector(`[data-chem_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_moct1);
                                    const nextCell = document.querySelector(`[data-chem_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_moct = d.val().hom_moct;
                        if (!hom_moct) { hom_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_moct1="${N0}">${hom_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_moct1);
                                    const nextCell = document.querySelector(`[data-hom_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_moct1);
                                    const nextCell = document.querySelector(`[data-hom_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_moct1);
                                    const nextCell = document.querySelector(`[data-hom_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_moct = d.val().eco_moct;
                        if (!eco_moct) { eco_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_moct1="${N0}">${eco_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_moct1);
                                    const nextCell = document.querySelector(`[data-eco_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_moct1);
                                    const nextCell = document.querySelector(`[data-eco_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_moct1);
                                    const nextCell = document.querySelector(`[data-eco_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_moct = d.val().bio_moct;
                        if (!bio_moct) { bio_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_moct1="${N0}">${bio_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_moct1);
                                    const nextCell = document.querySelector(`[data-bio_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_moct1);
                                    const nextCell = document.querySelector(`[data-bio_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_moct1);
                                    const nextCell = document.querySelector(`[data-bio_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែវិច្ឆិកា
    if (user_month == 'November') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mnov = d.val().e_mnov;
                        if (!e_mnov) { e_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mnov1="${N0}">${e_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov1);
                                    const nextCell = document.querySelector(`[data-e_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov1);
                                    const nextCell = document.querySelector(`[data-e_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov1);
                                    const nextCell = document.querySelector(`[data-e_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mnov = d.val().pe_mnov;
                        if (!pe_mnov) { pe_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mnov1="${N0}">${pe_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mnov1);
                                    const nextCell = document.querySelector(`[data-pe_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mnov1);
                                    const nextCell = document.querySelector(`[data-pe_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mnov1);
                                    const nextCell = document.querySelector(`[data-pe_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mnov = d.val().mo_mnov;
                        if (!mo_mnov) { mo_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mnov1="${N0}">${mo_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mnov1);
                                    const nextCell = document.querySelector(`[data-mo_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mnov1);
                                    const nextCell = document.querySelector(`[data-mo_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mnov1);
                                    const nextCell = document.querySelector(`[data-mo_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mnov = d.val().ict_mnov;
                        if (!ict_mnov) { ict_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mnov1="${N0}">${ict_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mnov1);
                                    const nextCell = document.querySelector(`[data-ict_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mnov1);
                                    const nextCell = document.querySelector(`[data-ict_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mnov1);
                                    const nextCell = document.querySelector(`[data-ict_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mnov = d.val().math_mnov;
                        if (!math_mnov) { math_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mnov1="${N0}">${math_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mnov1);
                                    const nextCell = document.querySelector(`[data-math_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mnov1);
                                    const nextCell = document.querySelector(`[data-math_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mnov1);
                                    const nextCell = document.querySelector(`[data-math_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mnov = d.val().k_mnov;
                        if (!k_mnov) { k_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mnov1="${N0}">${k_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mnov1);
                                    const nextCell = document.querySelector(`[data-k_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mnov1);
                                    const nextCell = document.querySelector(`[data-k_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mnov1);
                                    const nextCell = document.querySelector(`[data-k_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mnov = d.val().hist_mnov;
                        if (!hist_mnov) { hist_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mnov1="${N0}">${hist_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mnov1);
                                    const nextCell = document.querySelector(`[data-hist_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mnov1);
                                    const nextCell = document.querySelector(`[data-hist_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mnov1);
                                    const nextCell = document.querySelector(`[data-hist_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mnov = d.val().earth_mnov;
                        if (!earth_mnov) { earth_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mnov1="${N0}">${earth_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mnov1);
                                    const nextCell = document.querySelector(`[data-earth_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mnov1);
                                    const nextCell = document.querySelector(`[data-earth_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mnov1);
                                    const nextCell = document.querySelector(`[data-earth_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mnov = d.val().geor_mnov;
                        if (!geor_mnov) { geor_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mnov1="${N0}">${geor_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mnov1);
                                    const nextCell = document.querySelector(`[data-geor_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mnov1);
                                    const nextCell = document.querySelector(`[data-geor_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mnov1);
                                    const nextCell = document.querySelector(`[data-geor_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mnov = d.val().phy_mnov;
                        if (!phy_mnov) { phy_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mnov1="${N0}">${phy_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mnov1);
                                    const nextCell = document.querySelector(`[data-phy_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mnov1);
                                    const nextCell = document.querySelector(`[data-phy_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mnov1);
                                    const nextCell = document.querySelector(`[data-phy_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mnov = d.val().chem_mnov;
                        if (!chem_mnov) { chem_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mnov1="${N0}">${chem_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mnov1);
                                    const nextCell = document.querySelector(`[data-chem_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mnov1);
                                    const nextCell = document.querySelector(`[data-chem_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mnov1);
                                    const nextCell = document.querySelector(`[data-chem_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mnov = d.val().hom_mnov;
                        if (!hom_mnov) { hom_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mnov1="${N0}">${hom_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mnov1);
                                    const nextCell = document.querySelector(`[data-hom_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mnov1);
                                    const nextCell = document.querySelector(`[data-hom_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mnov1);
                                    const nextCell = document.querySelector(`[data-hom_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mnov = d.val().eco_mnov;
                        if (!eco_mnov) { eco_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mnov1="${N0}">${eco_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mnov1);
                                    const nextCell = document.querySelector(`[data-eco_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mnov1);
                                    const nextCell = document.querySelector(`[data-eco_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mnov1);
                                    const nextCell = document.querySelector(`[data-eco_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mnov = d.val().bio_mnov;
                        if (!bio_mnov) { bio_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mnov="${N0}">${bio_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mnov);
                                    const nextCell = document.querySelector(`[data-bio_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mnov);
                                    const nextCell = document.querySelector(`[data-bio_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mnov);
                                    const nextCell = document.querySelector(`[data-bio_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែធ្នូ
    if (user_month == 'December') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mdec = d.val().e_mdec;
                        if (!e_mdec) { e_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mdec1="${N0}">${e_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec1);
                                    const nextCell = document.querySelector(`[data-e_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec1);
                                    const nextCell = document.querySelector(`[data-e_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec1);
                                    const nextCell = document.querySelector(`[data-e_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mdec = d.val().pe_mdec;
                        if (!pe_mdec) { pe_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mdec1="${N0}">${pe_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mdec1);
                                    const nextCell = document.querySelector(`[data-pe_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mdec1);
                                    const nextCell = document.querySelector(`[data-pe_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mdec1);
                                    const nextCell = document.querySelector(`[data-pe_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mdec = d.val().mo_mdec;
                        if (!mo_mdec) { mo_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mdec1="${N0}">${mo_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mdec1);
                                    const nextCell = document.querySelector(`[data-mo_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mdec1);
                                    const nextCell = document.querySelector(`[data-mo_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mdec1);
                                    const nextCell = document.querySelector(`[data-mo_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mdec = d.val().ict_mdec;
                        if (!ict_mdec) { ict_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mdec1="${N0}">${ict_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mdec1);
                                    const nextCell = document.querySelector(`[data-ict_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mdec1);
                                    const nextCell = document.querySelector(`[data-ict_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mdec1);
                                    const nextCell = document.querySelector(`[data-ict_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mdec = d.val().math_mdec;
                        if (!math_mdec) { math_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mdec1="${N0}">${math_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mdec1);
                                    const nextCell = document.querySelector(`[data-math_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mdec1);
                                    const nextCell = document.querySelector(`[data-math_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mdec1);
                                    const nextCell = document.querySelector(`[data-math_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mdec = d.val().k_mdec;
                        if (!k_mdec) { k_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mdec1="${N0}">${k_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mdec1);
                                    const nextCell = document.querySelector(`[data-k_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mdec1);
                                    const nextCell = document.querySelector(`[data-k_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mdec1);
                                    const nextCell = document.querySelector(`[data-k_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mdec = d.val().hist_mdec;
                        if (!hist_mdec) { hist_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mdec1="${N0}">${hist_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mdec1);
                                    const nextCell = document.querySelector(`[data-hist_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mdec1);
                                    const nextCell = document.querySelector(`[data-hist_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mdec1);
                                    const nextCell = document.querySelector(`[data-hist_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mdec = d.val().earth_mdec;
                        if (!earth_mdec) { earth_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mdec1="${N0}">${earth_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mdec1);
                                    const nextCell = document.querySelector(`[data-earth_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mdec1);
                                    const nextCell = document.querySelector(`[data-earth_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mdec1);
                                    const nextCell = document.querySelector(`[data-earth_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mdec = d.val().geor_mdec;
                        if (!geor_mdec) { geor_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mdec1="${N0}">${geor_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mdec1);
                                    const nextCell = document.querySelector(`[data-geor_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mdec1);
                                    const nextCell = document.querySelector(`[data-geor_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mdec1);
                                    const nextCell = document.querySelector(`[data-geor_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mdec = d.val().phy_mdec;
                        if (!phy_mdec) { phy_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mdec1="${N0}">${phy_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mdec1);
                                    const nextCell = document.querySelector(`[data-phy_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mdec1);
                                    const nextCell = document.querySelector(`[data-phy_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mdec1);
                                    const nextCell = document.querySelector(`[data-phy_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mdec = d.val().chem_mdec;
                        if (!chem_mdec) { chem_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mdec1="${N0}">${chem_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mdec1);
                                    const nextCell = document.querySelector(`[data-chem_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mdec1);
                                    const nextCell = document.querySelector(`[data-chem_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mdec1);
                                    const nextCell = document.querySelector(`[data-chem_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mdec = d.val().hom_mdec;
                        if (!hom_mdec) { hom_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mdec1="${N0}">${hom_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mdec1);
                                    const nextCell = document.querySelector(`[data-hom_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mdec1);
                                    const nextCell = document.querySelector(`[data-hom_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mdec1);
                                    const nextCell = document.querySelector(`[data-hom_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mdec = d.val().eco_mdec;
                        if (!eco_mdec) { eco_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mdec1="${N0}">${eco_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mdec1);
                                    const nextCell = document.querySelector(`[data-eco_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mdec1);
                                    const nextCell = document.querySelector(`[data-eco_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mdec1);
                                    const nextCell = document.querySelector(`[data-eco_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mdec = d.val().bio_mdec;
                        if (!bio_mdec) { bio_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mdec="${N0}">${bio_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mdec);
                                    const nextCell = document.querySelector(`[data-bio_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mdec);
                                    const nextCell = document.querySelector(`[data-bio_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mdec);
                                    const nextCell = document.querySelector(`[data-bio_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែមករា
    if (user_month == 'January') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mjan = d.val().e_mjan;
                        if (!e_mjan) { e_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mjan1="${N0}">${e_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan1);
                                    const nextCell = document.querySelector(`[data-e_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan1);
                                    const nextCell = document.querySelector(`[data-e_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan1);
                                    const nextCell = document.querySelector(`[data-e_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mjan = d.val().pe_mjan;
                        if (!pe_mjan) { pe_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mjan1="${N0}">${pe_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjan1);
                                    const nextCell = document.querySelector(`[data-pe_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjan1);
                                    const nextCell = document.querySelector(`[data-pe_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjan1);
                                    const nextCell = document.querySelector(`[data-pe_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mjan = d.val().mo_mjan;
                        if (!mo_mjan) { mo_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mjan1="${N0}">${mo_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjan1);
                                    const nextCell = document.querySelector(`[data-mo_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjan1);
                                    const nextCell = document.querySelector(`[data-mo_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjan1);
                                    const nextCell = document.querySelector(`[data-mo_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mjan = d.val().ict_mjan;
                        if (!ict_mjan) { ict_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mjan1="${N0}">${ict_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjan1);
                                    const nextCell = document.querySelector(`[data-ict_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjan1);
                                    const nextCell = document.querySelector(`[data-ict_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjan1);
                                    const nextCell = document.querySelector(`[data-ict_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mjan = d.val().math_mjan;
                        if (!math_mjan) { math_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mjan1="${N0}">${math_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjan1);
                                    const nextCell = document.querySelector(`[data-math_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjan1);
                                    const nextCell = document.querySelector(`[data-math_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjan1);
                                    const nextCell = document.querySelector(`[data-math_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mjan = d.val().k_mjan;
                        if (!k_mjan) { k_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mjan1="${N0}">${k_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjan1);
                                    const nextCell = document.querySelector(`[data-k_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjan1);
                                    const nextCell = document.querySelector(`[data-k_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjan1);
                                    const nextCell = document.querySelector(`[data-k_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mjan = d.val().hist_mjan;
                        if (!hist_mjan) { hist_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mjan1="${N0}">${hist_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjan1);
                                    const nextCell = document.querySelector(`[data-hist_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjan1);
                                    const nextCell = document.querySelector(`[data-hist_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjan1);
                                    const nextCell = document.querySelector(`[data-hist_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mjan = d.val().earth_mjan;
                        if (!earth_mjan) { earth_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mjan1="${N0}">${earth_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjan1);
                                    const nextCell = document.querySelector(`[data-earth_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjan1);
                                    const nextCell = document.querySelector(`[data-earth_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjan1);
                                    const nextCell = document.querySelector(`[data-earth_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mjan = d.val().geor_mjan;
                        if (!geor_mjan) { geor_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mjan1="${N0}">${geor_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjan1);
                                    const nextCell = document.querySelector(`[data-geor_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjan1);
                                    const nextCell = document.querySelector(`[data-geor_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjan1);
                                    const nextCell = document.querySelector(`[data-geor_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mjan = d.val().phy_mjan;
                        if (!phy_mjan) { phy_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mjan1="${N0}">${phy_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjan1);
                                    const nextCell = document.querySelector(`[data-phy_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjan1);
                                    const nextCell = document.querySelector(`[data-phy_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjan1);
                                    const nextCell = document.querySelector(`[data-phy_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mjan = d.val().chem_mjan;
                        if (!chem_mjan) { chem_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mjan1="${N0}">${chem_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjan1);
                                    const nextCell = document.querySelector(`[data-chem_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjan1);
                                    const nextCell = document.querySelector(`[data-chem_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjan1);
                                    const nextCell = document.querySelector(`[data-chem_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mjan = d.val().hom_mjan;
                        if (!hom_mjan) { hom_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mjan1="${N0}">${hom_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjan1);
                                    const nextCell = document.querySelector(`[data-hom_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjan1);
                                    const nextCell = document.querySelector(`[data-hom_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjan1);
                                    const nextCell = document.querySelector(`[data-hom_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mjan = d.val().eco_mjan;
                        if (!eco_mjan) { eco_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mjan1="${N0}">${eco_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjan1);
                                    const nextCell = document.querySelector(`[data-eco_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjan1);
                                    const nextCell = document.querySelector(`[data-eco_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjan1);
                                    const nextCell = document.querySelector(`[data-eco_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mjan = d.val().bio_mjan;
                        if (!bio_mjan) { bio_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mjan="${N0}">${bio_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjan);
                                    const nextCell = document.querySelector(`[data-bio_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjan);
                                    const nextCell = document.querySelector(`[data-bio_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjan);
                                    const nextCell = document.querySelector(`[data-bio_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែកុម្ភៈ
    if (user_month == 'February') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mfeb = d.val().e_mfeb;
                        if (!e_mfeb) { e_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mfeb1="${N0}">${e_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb1);
                                    const nextCell = document.querySelector(`[data-e_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb1);
                                    const nextCell = document.querySelector(`[data-e_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb1);
                                    const nextCell = document.querySelector(`[data-e_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mfeb = d.val().pe_mfeb;
                        if (!pe_mfeb) { pe_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mfeb1="${N0}">${pe_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mfeb1);
                                    const nextCell = document.querySelector(`[data-pe_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mfeb1);
                                    const nextCell = document.querySelector(`[data-pe_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mfeb1);
                                    const nextCell = document.querySelector(`[data-pe_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mfeb = d.val().mo_mfeb;
                        if (!mo_mfeb) { mo_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mfeb1="${N0}">${mo_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mfeb1);
                                    const nextCell = document.querySelector(`[data-mo_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mfeb1);
                                    const nextCell = document.querySelector(`[data-mo_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mfeb1);
                                    const nextCell = document.querySelector(`[data-mo_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mfeb = d.val().ict_mfeb;
                        if (!ict_mfeb) { ict_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mfeb1="${N0}">${ict_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mfeb1);
                                    const nextCell = document.querySelector(`[data-ict_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mfeb1);
                                    const nextCell = document.querySelector(`[data-ict_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mfeb1);
                                    const nextCell = document.querySelector(`[data-ict_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mfeb = d.val().math_mfeb;
                        if (!math_mfeb) { math_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mfeb1="${N0}">${math_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mfeb1);
                                    const nextCell = document.querySelector(`[data-math_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mfeb1);
                                    const nextCell = document.querySelector(`[data-math_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mfeb1);
                                    const nextCell = document.querySelector(`[data-math_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mfeb = d.val().k_mfeb;
                        if (!k_mfeb) { k_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mfeb1="${N0}">${k_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mfeb1);
                                    const nextCell = document.querySelector(`[data-k_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mfeb1);
                                    const nextCell = document.querySelector(`[data-k_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mfeb1);
                                    const nextCell = document.querySelector(`[data-k_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mfeb = d.val().hist_mfeb;
                        if (!hist_mfeb) { hist_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mfeb1="${N0}">${hist_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mfeb1);
                                    const nextCell = document.querySelector(`[data-hist_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mfeb1);
                                    const nextCell = document.querySelector(`[data-hist_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mfeb1);
                                    const nextCell = document.querySelector(`[data-hist_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mfeb = d.val().earth_mfeb;
                        if (!earth_mfeb) { earth_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mfeb1="${N0}">${earth_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mfeb1);
                                    const nextCell = document.querySelector(`[data-earth_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mfeb1);
                                    const nextCell = document.querySelector(`[data-earth_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mfeb1);
                                    const nextCell = document.querySelector(`[data-earth_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mfeb = d.val().geor_mfeb;
                        if (!geor_mfeb) { geor_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mfeb1="${N0}">${geor_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mfeb1);
                                    const nextCell = document.querySelector(`[data-geor_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mfeb1);
                                    const nextCell = document.querySelector(`[data-geor_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mfeb1);
                                    const nextCell = document.querySelector(`[data-geor_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mfeb = d.val().phy_mfeb;
                        if (!phy_mfeb) { phy_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mfeb1="${N0}">${phy_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mfeb1);
                                    const nextCell = document.querySelector(`[data-phy_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mfeb1);
                                    const nextCell = document.querySelector(`[data-phy_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mfeb1);
                                    const nextCell = document.querySelector(`[data-phy_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mfeb = d.val().chem_mfeb;
                        if (!chem_mfeb) { chem_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mfeb1="${N0}">${chem_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mfeb1);
                                    const nextCell = document.querySelector(`[data-chem_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mfeb1);
                                    const nextCell = document.querySelector(`[data-chem_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mfeb1);
                                    const nextCell = document.querySelector(`[data-chem_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mfeb = d.val().hom_mfeb;
                        if (!hom_mfeb) { hom_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mfeb1="${N0}">${hom_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mfeb1);
                                    const nextCell = document.querySelector(`[data-hom_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mfeb1);
                                    const nextCell = document.querySelector(`[data-hom_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mfeb1);
                                    const nextCell = document.querySelector(`[data-hom_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mfeb = d.val().eco_mfeb;
                        if (!eco_mfeb) { eco_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mfeb1="${N0}">${eco_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mfeb1);
                                    const nextCell = document.querySelector(`[data-eco_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mfeb1);
                                    const nextCell = document.querySelector(`[data-eco_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mfeb1);
                                    const nextCell = document.querySelector(`[data-eco_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mfeb = d.val().bio_mfeb;
                        if (!bio_mfeb) { bio_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mfeb="${N0}">${bio_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mfeb);
                                    const nextCell = document.querySelector(`[data-bio_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mfeb);
                                    const nextCell = document.querySelector(`[data-bio_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mfeb);
                                    const nextCell = document.querySelector(`[data-bio_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
    }

    // ខែមីនា
    if (user_month == 'March') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mmarch = d.val().e_mmarch;
                        if (!e_mmarch) { e_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mmarch1="${N0}">${e_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch1);
                                    const nextCell = document.querySelector(`[data-e_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch1);
                                    const nextCell = document.querySelector(`[data-e_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch1);
                                    const nextCell = document.querySelector(`[data-e_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mmarch = d.val().pe_mmarch;
                        if (!pe_mmarch) { pe_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mmarch1="${N0}">${pe_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mmarch1);
                                    const nextCell = document.querySelector(`[data-pe_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mmarch1);
                                    const nextCell = document.querySelector(`[data-pe_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mmarch1);
                                    const nextCell = document.querySelector(`[data-pe_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mmarch = d.val().mo_mmarch;
                        if (!mo_mmarch) { mo_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mmarch1="${N0}">${mo_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mmarch1);
                                    const nextCell = document.querySelector(`[data-mo_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mmarch1);
                                    const nextCell = document.querySelector(`[data-mo_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mmarch1);
                                    const nextCell = document.querySelector(`[data-mo_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mmarch = d.val().ict_mmarch;
                        if (!ict_mmarch) { ict_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mmarch1="${N0}">${ict_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mmarch1);
                                    const nextCell = document.querySelector(`[data-ict_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mmarch1);
                                    const nextCell = document.querySelector(`[data-ict_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mmarch1);
                                    const nextCell = document.querySelector(`[data-ict_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mmarch = d.val().math_mmarch;
                        if (!math_mmarch) { math_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mmarch1="${N0}">${math_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mmarch1);
                                    const nextCell = document.querySelector(`[data-math_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mmarch1);
                                    const nextCell = document.querySelector(`[data-math_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mmarch1);
                                    const nextCell = document.querySelector(`[data-math_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mmarch = d.val().k_mmarch;
                        if (!k_mmarch) { k_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mmarch1="${N0}">${k_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mmarch1);
                                    const nextCell = document.querySelector(`[data-k_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mmarch1);
                                    const nextCell = document.querySelector(`[data-k_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mmarch1);
                                    const nextCell = document.querySelector(`[data-k_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mmarch = d.val().hist_mmarch;
                        if (!hist_mmarch) { hist_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mmarch1="${N0}">${hist_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mmarch1);
                                    const nextCell = document.querySelector(`[data-hist_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mmarch1);
                                    const nextCell = document.querySelector(`[data-hist_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mmarch1);
                                    const nextCell = document.querySelector(`[data-hist_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mmarch = d.val().earth_mmarch;
                        if (!earth_mmarch) { earth_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mmarch1="${N0}">${earth_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mmarch1);
                                    const nextCell = document.querySelector(`[data-earth_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mmarch1);
                                    const nextCell = document.querySelector(`[data-earth_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mmarch1);
                                    const nextCell = document.querySelector(`[data-earth_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mmarch = d.val().geor_mmarch;
                        if (!geor_mmarch) { geor_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mmarch1="${N0}">${geor_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mmarch1);
                                    const nextCell = document.querySelector(`[data-geor_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mmarch1);
                                    const nextCell = document.querySelector(`[data-geor_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mmarch1);
                                    const nextCell = document.querySelector(`[data-geor_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mmarch = d.val().phy_mmarch;
                        if (!phy_mmarch) { phy_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mmarch1="${N0}">${phy_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mmarch1);
                                    const nextCell = document.querySelector(`[data-phy_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mmarch1);
                                    const nextCell = document.querySelector(`[data-phy_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mmarch1);
                                    const nextCell = document.querySelector(`[data-phy_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mmarch = d.val().chem_mmarch;
                        if (!chem_mmarch) { chem_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mmarch1="${N0}">${chem_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mmarch1);
                                    const nextCell = document.querySelector(`[data-chem_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mmarch1);
                                    const nextCell = document.querySelector(`[data-chem_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mmarch1);
                                    const nextCell = document.querySelector(`[data-chem_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mmarch = d.val().hom_mmarch;
                        if (!hom_mmarch) { hom_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mmarch1="${N0}">${hom_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mmarch1);
                                    const nextCell = document.querySelector(`[data-hom_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mmarch1);
                                    const nextCell = document.querySelector(`[data-hom_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mmarch1);
                                    const nextCell = document.querySelector(`[data-hom_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mmarch = d.val().eco_mmarch;
                        if (!eco_mmarch) { eco_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mmarch1="${N0}">${eco_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mmarch1);
                                    const nextCell = document.querySelector(`[data-eco_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mmarch1);
                                    const nextCell = document.querySelector(`[data-eco_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mmarch1);
                                    const nextCell = document.querySelector(`[data-eco_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mmarch = d.val().bio_mmarch;
                        if (!bio_mmarch) { bio_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mmarch="${N0}">${bio_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mmarch);
                                    const nextCell = document.querySelector(`[data-bio_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mmarch);
                                    const nextCell = document.querySelector(`[data-bio_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mmarch);
                                    const nextCell = document.querySelector(`[data-bio_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែមេសា-ឧសភា
    if (user_month == 'April-May') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mapma = d.val().e_mapma;
                        if (!e_mapma) { e_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mapma1="${N0}">${e_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma1);
                                    const nextCell = document.querySelector(`[data-e_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma1);
                                    const nextCell = document.querySelector(`[data-e_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma1);
                                    const nextCell = document.querySelector(`[data-e_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mapma = d.val().pe_mapma;
                        if (!pe_mapma) { pe_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mapma1="${N0}">${pe_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mapma1);
                                    const nextCell = document.querySelector(`[data-pe_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mapma1);
                                    const nextCell = document.querySelector(`[data-pe_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mapma1);
                                    const nextCell = document.querySelector(`[data-pe_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mapma = d.val().mo_mapma;
                        if (!mo_mapma) { mo_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mapma1="${N0}">${mo_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mapma1);
                                    const nextCell = document.querySelector(`[data-mo_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mapma1);
                                    const nextCell = document.querySelector(`[data-mo_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mapma1);
                                    const nextCell = document.querySelector(`[data-mo_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mapma = d.val().ict_mapma;
                        if (!ict_mapma) { ict_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mapma1="${N0}">${ict_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mapma1);
                                    const nextCell = document.querySelector(`[data-ict_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mapma1);
                                    const nextCell = document.querySelector(`[data-ict_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mapma1);
                                    const nextCell = document.querySelector(`[data-ict_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mapma = d.val().math_mapma;
                        if (!math_mapma) { math_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mapma1="${N0}">${math_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mapma1);
                                    const nextCell = document.querySelector(`[data-math_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mapma1);
                                    const nextCell = document.querySelector(`[data-math_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mapma1);
                                    const nextCell = document.querySelector(`[data-math_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mapma = d.val().k_mapma;
                        if (!k_mapma) { k_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mapma1="${N0}">${k_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mapma1);
                                    const nextCell = document.querySelector(`[data-k_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mapma1);
                                    const nextCell = document.querySelector(`[data-k_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mapma1);
                                    const nextCell = document.querySelector(`[data-k_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mapma = d.val().hist_mapma;
                        if (!hist_mapma) { hist_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mapma1="${N0}">${hist_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mapma1);
                                    const nextCell = document.querySelector(`[data-hist_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mapma1);
                                    const nextCell = document.querySelector(`[data-hist_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mapma1);
                                    const nextCell = document.querySelector(`[data-hist_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mapma = d.val().earth_mapma;
                        if (!earth_mapma) { earth_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mapma1="${N0}">${earth_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mapma1);
                                    const nextCell = document.querySelector(`[data-earth_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mapma1);
                                    const nextCell = document.querySelector(`[data-earth_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mapma1);
                                    const nextCell = document.querySelector(`[data-earth_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mapma = d.val().geor_mapma;
                        if (!geor_mapma) { geor_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mapma1="${N0}">${geor_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mapma1);
                                    const nextCell = document.querySelector(`[data-geor_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mapma1);
                                    const nextCell = document.querySelector(`[data-geor_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mapma1);
                                    const nextCell = document.querySelector(`[data-geor_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mapma = d.val().phy_mapma;
                        if (!phy_mapma) { phy_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mapma1="${N0}">${phy_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mapma1);
                                    const nextCell = document.querySelector(`[data-phy_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mapma1);
                                    const nextCell = document.querySelector(`[data-phy_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mapma1);
                                    const nextCell = document.querySelector(`[data-phy_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mapma = d.val().chem_mapma;
                        if (!chem_mapma) { chem_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mapma1="${N0}">${chem_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mapma1);
                                    const nextCell = document.querySelector(`[data-chem_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mapma1);
                                    const nextCell = document.querySelector(`[data-chem_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mapma1);
                                    const nextCell = document.querySelector(`[data-chem_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mapma = d.val().hom_mapma;
                        if (!hom_mapma) { hom_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mapma1="${N0}">${hom_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mapma1);
                                    const nextCell = document.querySelector(`[data-hom_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mapma1);
                                    const nextCell = document.querySelector(`[data-hom_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mapma1);
                                    const nextCell = document.querySelector(`[data-hom_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mapma = d.val().eco_mapma;
                        if (!eco_mapma) { eco_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mapma1="${N0}">${eco_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mapma1);
                                    const nextCell = document.querySelector(`[data-eco_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mapma1);
                                    const nextCell = document.querySelector(`[data-eco_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mapma1);
                                    const nextCell = document.querySelector(`[data-eco_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mapma = d.val().bio_mapma;
                        if (!bio_mapma) { bio_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mapma="${N0}">${bio_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mapma);
                                    const nextCell = document.querySelector(`[data-bio_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mapma);
                                    const nextCell = document.querySelector(`[data-bio_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mapma);
                                    const nextCell = document.querySelector(`[data-bio_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែមិថុនា
    if (user_month == 'June') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mjun = d.val().e_mjun;
                        if (!e_mjun) { e_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mjun1="${N0}">${e_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun1);
                                    const nextCell = document.querySelector(`[data-e_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun1);
                                    const nextCell = document.querySelector(`[data-e_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun1);
                                    const nextCell = document.querySelector(`[data-e_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mjun = d.val().pe_mjun;
                        if (!pe_mjun) { pe_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mjun1="${N0}">${pe_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjun1);
                                    const nextCell = document.querySelector(`[data-pe_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjun1);
                                    const nextCell = document.querySelector(`[data-pe_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjun1);
                                    const nextCell = document.querySelector(`[data-pe_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mjun = d.val().mo_mjun;
                        if (!mo_mjun) { mo_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mjun1="${N0}">${mo_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjun1);
                                    const nextCell = document.querySelector(`[data-mo_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjun1);
                                    const nextCell = document.querySelector(`[data-mo_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjun1);
                                    const nextCell = document.querySelector(`[data-mo_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mjun = d.val().ict_mjun;
                        if (!ict_mjun) { ict_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mjun1="${N0}">${ict_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjun1);
                                    const nextCell = document.querySelector(`[data-ict_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjun1);
                                    const nextCell = document.querySelector(`[data-ict_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjun1);
                                    const nextCell = document.querySelector(`[data-ict_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mjun = d.val().math_mjun;
                        if (!math_mjun) { math_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mjun1="${N0}">${math_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjun1);
                                    const nextCell = document.querySelector(`[data-math_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjun1);
                                    const nextCell = document.querySelector(`[data-math_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjun1);
                                    const nextCell = document.querySelector(`[data-math_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mjun = d.val().k_mjun;
                        if (!k_mjun) { k_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mjun1="${N0}">${k_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjun1);
                                    const nextCell = document.querySelector(`[data-k_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjun1);
                                    const nextCell = document.querySelector(`[data-k_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjun1);
                                    const nextCell = document.querySelector(`[data-k_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mjun = d.val().hist_mjun;
                        if (!hist_mjun) { hist_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mjun1="${N0}">${hist_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjun1);
                                    const nextCell = document.querySelector(`[data-hist_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjun1);
                                    const nextCell = document.querySelector(`[data-hist_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjun1);
                                    const nextCell = document.querySelector(`[data-hist_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mjun = d.val().earth_mjun;
                        if (!earth_mjun) { earth_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mjun1="${N0}">${earth_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjun1);
                                    const nextCell = document.querySelector(`[data-earth_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjun1);
                                    const nextCell = document.querySelector(`[data-earth_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjun1);
                                    const nextCell = document.querySelector(`[data-earth_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mjun = d.val().geor_mjun;
                        if (!geor_mjun) { geor_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mjun1="${N0}">${geor_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjun1);
                                    const nextCell = document.querySelector(`[data-geor_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjun1);
                                    const nextCell = document.querySelector(`[data-geor_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjun1);
                                    const nextCell = document.querySelector(`[data-geor_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mjun = d.val().phy_mjun;
                        if (!phy_mjun) { phy_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mjun1="${N0}">${phy_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjun1);
                                    const nextCell = document.querySelector(`[data-phy_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjun1);
                                    const nextCell = document.querySelector(`[data-phy_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjun1);
                                    const nextCell = document.querySelector(`[data-phy_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mjun = d.val().chem_mjun;
                        if (!chem_mjun) { chem_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mjun1="${N0}">${chem_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjun1);
                                    const nextCell = document.querySelector(`[data-chem_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjun1);
                                    const nextCell = document.querySelector(`[data-chem_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjun1);
                                    const nextCell = document.querySelector(`[data-chem_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mjun = d.val().hom_mjun;
                        if (!hom_mjun) { hom_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mjun1="${N0}">${hom_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjun1);
                                    const nextCell = document.querySelector(`[data-hom_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjun1);
                                    const nextCell = document.querySelector(`[data-hom_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjun1);
                                    const nextCell = document.querySelector(`[data-hom_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mjun = d.val().eco_mjun;
                        if (!eco_mjun) { eco_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mjun1="${N0}">${eco_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjun1);
                                    const nextCell = document.querySelector(`[data-eco_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjun1);
                                    const nextCell = document.querySelector(`[data-eco_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjun1);
                                    const nextCell = document.querySelector(`[data-eco_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mjun = d.val().bio_mjun;
                        if (!bio_mjun) { bio_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mjun="${N0}">${bio_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjun);
                                    const nextCell = document.querySelector(`[data-bio_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjun);
                                    const nextCell = document.querySelector(`[data-bio_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjun);
                                    const nextCell = document.querySelector(`[data-bio_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ខែកក្កដា
    if (user_month == 'July') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mjul = d.val().e_mjul;
                        if (!e_mjul) { e_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mjul1="${N0}">${e_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul1);
                                    const nextCell = document.querySelector(`[data-e_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul1);
                                    const nextCell = document.querySelector(`[data-e_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul1);
                                    const nextCell = document.querySelector(`[data-e_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mjul = d.val().pe_mjul;
                        if (!pe_mjul) { pe_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mjul1="${N0}">${pe_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjul1);
                                    const nextCell = document.querySelector(`[data-pe_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjul1);
                                    const nextCell = document.querySelector(`[data-pe_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjul1);
                                    const nextCell = document.querySelector(`[data-pe_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_mjul = d.val().mo_mjul;
                        if (!mo_mjul) { mo_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_mjul1="${N0}">${mo_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjul1);
                                    const nextCell = document.querySelector(`[data-mo_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjul1);
                                    const nextCell = document.querySelector(`[data-mo_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_mjul1);
                                    const nextCell = document.querySelector(`[data-mo_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_mjul = d.val().ict_mjul;
                        if (!ict_mjul) { ict_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_mjul1="${N0}">${ict_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjul1);
                                    const nextCell = document.querySelector(`[data-ict_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjul1);
                                    const nextCell = document.querySelector(`[data-ict_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_mjul1);
                                    const nextCell = document.querySelector(`[data-ict_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mjul = d.val().math_mjul;
                        if (!math_mjul) { math_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mjul1="${N0}">${math_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjul1);
                                    const nextCell = document.querySelector(`[data-math_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjul1);
                                    const nextCell = document.querySelector(`[data-math_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjul1);
                                    const nextCell = document.querySelector(`[data-math_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_mjul = d.val().k_mjul;
                        if (!k_mjul) { k_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_mjul1="${N0}">${k_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjul1);
                                    const nextCell = document.querySelector(`[data-k_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjul1);
                                    const nextCell = document.querySelector(`[data-k_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_mjul1);
                                    const nextCell = document.querySelector(`[data-k_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mjul = d.val().hist_mjul;
                        if (!hist_mjul) { hist_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mjul1="${N0}">${hist_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjul1);
                                    const nextCell = document.querySelector(`[data-hist_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjul1);
                                    const nextCell = document.querySelector(`[data-hist_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjul1);
                                    const nextCell = document.querySelector(`[data-hist_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_mjul = d.val().earth_mjul;
                        if (!earth_mjul) { earth_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_mjul1="${N0}">${earth_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjul1);
                                    const nextCell = document.querySelector(`[data-earth_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjul1);
                                    const nextCell = document.querySelector(`[data-earth_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_mjul1);
                                    const nextCell = document.querySelector(`[data-earth_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mjul = d.val().geor_mjul;
                        if (!geor_mjul) { geor_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mjul1="${N0}">${geor_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjul1);
                                    const nextCell = document.querySelector(`[data-geor_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjul1);
                                    const nextCell = document.querySelector(`[data-geor_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjul1);
                                    const nextCell = document.querySelector(`[data-geor_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_mjul = d.val().phy_mjul;
                        if (!phy_mjul) { phy_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_mjul1="${N0}">${phy_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjul1);
                                    const nextCell = document.querySelector(`[data-phy_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjul1);
                                    const nextCell = document.querySelector(`[data-phy_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_mjul1);
                                    const nextCell = document.querySelector(`[data-phy_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_mjul = d.val().chem_mjul;
                        if (!chem_mjul) { chem_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_mjul1="${N0}">${chem_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjul1);
                                    const nextCell = document.querySelector(`[data-chem_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjul1);
                                    const nextCell = document.querySelector(`[data-chem_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_mjul1);
                                    const nextCell = document.querySelector(`[data-chem_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_mjul = d.val().hom_mjul;
                        if (!hom_mjul) { hom_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_mjul1="${N0}">${hom_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjul1);
                                    const nextCell = document.querySelector(`[data-hom_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjul1);
                                    const nextCell = document.querySelector(`[data-hom_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_mjul1);
                                    const nextCell = document.querySelector(`[data-hom_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_mjul = d.val().eco_mjul;
                        if (!eco_mjul) { eco_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_mjul1="${N0}">${eco_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjul1);
                                    const nextCell = document.querySelector(`[data-eco_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjul1);
                                    const nextCell = document.querySelector(`[data-eco_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_mjul1);
                                    const nextCell = document.querySelector(`[data-eco_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_mjul = d.val().bio_mjul;
                        if (!bio_mjul) { bio_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_mjul="${N0}">${bio_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjul);
                                    const nextCell = document.querySelector(`[data-bio_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjul);
                                    const nextCell = document.querySelector(`[data-bio_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_mjul);
                                    const nextCell = document.querySelector(`[data-bio_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ឆមាសទី១
    if (user_month == '1st Semester') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_m1semester = d.val().e_m1semester;
                        if (!e_m1semester) { e_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_m1semester1="${N0}">${e_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester1);
                                    const nextCell = document.querySelector(`[data-e_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester1);
                                    const nextCell = document.querySelector(`[data-e_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester1);
                                    const nextCell = document.querySelector(`[data-e_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_m1semester = d.val().pe_m1semester;
                        if (!pe_m1semester) { pe_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_m1semester1="${N0}">${pe_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m1semester1);
                                    const nextCell = document.querySelector(`[data-pe_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m1semester1);
                                    const nextCell = document.querySelector(`[data-pe_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m1semester1);
                                    const nextCell = document.querySelector(`[data-pe_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_m1semester = d.val().mo_m1semester;
                        if (!mo_m1semester) { mo_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_m1semester1="${N0}">${mo_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_m1semester1);
                                    const nextCell = document.querySelector(`[data-mo_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_m1semester1);
                                    const nextCell = document.querySelector(`[data-mo_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_m1semester1);
                                    const nextCell = document.querySelector(`[data-mo_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_m1semester = d.val().ict_m1semester;
                        if (!ict_m1semester) { ict_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_m1semester1="${N0}">${ict_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_m1semester1);
                                    const nextCell = document.querySelector(`[data-ict_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_m1semester1);
                                    const nextCell = document.querySelector(`[data-ict_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_m1semester1);
                                    const nextCell = document.querySelector(`[data-ict_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_m1semester = d.val().math_m1semester;
                        if (!math_m1semester) { math_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_m1semester1="${N0}">${math_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m1semester1);
                                    const nextCell = document.querySelector(`[data-math_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m1semester1);
                                    const nextCell = document.querySelector(`[data-math_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m1semester1);
                                    const nextCell = document.querySelector(`[data-math_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_m1semester = d.val().k_m1semester;
                        if (!k_m1semester) { k_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_m1semester1="${N0}">${k_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_m1semester1);
                                    const nextCell = document.querySelector(`[data-k_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_m1semester1);
                                    const nextCell = document.querySelector(`[data-k_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_m1semester1);
                                    const nextCell = document.querySelector(`[data-k_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_m1semester = d.val().hist_m1semester;
                        if (!hist_m1semester) { hist_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_m1semester1="${N0}">${hist_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m1semester1);
                                    const nextCell = document.querySelector(`[data-hist_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m1semester1);
                                    const nextCell = document.querySelector(`[data-hist_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m1semester1);
                                    const nextCell = document.querySelector(`[data-hist_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_m1semester = d.val().earth_m1semester;
                        if (!earth_m1semester) { earth_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_m1semester1="${N0}">${earth_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_m1semester1);
                                    const nextCell = document.querySelector(`[data-earth_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_m1semester1);
                                    const nextCell = document.querySelector(`[data-earth_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_m1semester1);
                                    const nextCell = document.querySelector(`[data-earth_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_m1semester = d.val().geor_m1semester;
                        if (!geor_m1semester) { geor_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_m1semester1="${N0}">${geor_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m1semester1);
                                    const nextCell = document.querySelector(`[data-geor_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m1semester1);
                                    const nextCell = document.querySelector(`[data-geor_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m1semester1);
                                    const nextCell = document.querySelector(`[data-geor_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_m1semester = d.val().phy_m1semester;
                        if (!phy_m1semester) { phy_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_m1semester1="${N0}">${phy_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_m1semester1);
                                    const nextCell = document.querySelector(`[data-phy_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_m1semester1);
                                    const nextCell = document.querySelector(`[data-phy_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_m1semester1);
                                    const nextCell = document.querySelector(`[data-phy_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_m1semester = d.val().chem_m1semester;
                        if (!chem_m1semester) { chem_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_m1semester1="${N0}">${chem_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_m1semester1);
                                    const nextCell = document.querySelector(`[data-chem_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_m1semester1);
                                    const nextCell = document.querySelector(`[data-chem_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_m1semester1);
                                    const nextCell = document.querySelector(`[data-chem_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_m1semester = d.val().hom_m1semester;
                        if (!hom_m1semester) { hom_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_m1semester1="${N0}">${hom_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_m1semester1);
                                    const nextCell = document.querySelector(`[data-hom_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_m1semester1);
                                    const nextCell = document.querySelector(`[data-hom_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_m1semester1);
                                    const nextCell = document.querySelector(`[data-hom_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_m1semester = d.val().eco_m1semester;
                        if (!eco_m1semester) { eco_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_m1semester1="${N0}">${eco_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_m1semester1);
                                    const nextCell = document.querySelector(`[data-eco_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_m1semester1);
                                    const nextCell = document.querySelector(`[data-eco_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_m1semester1);
                                    const nextCell = document.querySelector(`[data-eco_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_m1semester = d.val().bio_m1semester;
                        if (!bio_m1semester) { bio_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_m1semester="${N0}">${bio_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_m1semester);
                                    const nextCell = document.querySelector(`[data-bio_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_m1semester);
                                    const nextCell = document.querySelector(`[data-bio_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_m1semester);
                                    const nextCell = document.querySelector(`[data-bio_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

    // ឆមាសទី២
    if (user_month == '2nd Semester') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_m2semester = d.val().e_m2semester;
                        if (!e_m2semester) { e_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_m2semester1="${N0}">${e_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester1);
                                    const nextCell = document.querySelector(`[data-e_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester1);
                                    const nextCell = document.querySelector(`[data-e_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester1);
                                    const nextCell = document.querySelector(`[data-e_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_m2semester = d.val().pe_m2semester;
                        if (!pe_m2semester) { pe_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_m2semester1="${N0}">${pe_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m2semester1);
                                    const nextCell = document.querySelector(`[data-pe_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m2semester1);
                                    const nextCell = document.querySelector(`[data-pe_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m2semester1);
                                    const nextCell = document.querySelector(`[data-pe_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var mo_m2semester = d.val().mo_m2semester;
                        if (!mo_m2semester) { mo_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}mo" contenteditable onclick="selectText(this)" data-mo_m2semester1="${N0}">${mo_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}mo`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}mo`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        mo_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_m2semester1);
                                    const nextCell = document.querySelector(`[data-mo_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_m2semester1);
                                    const nextCell = document.querySelector(`[data-mo_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.mo_m2semester1);
                                    const nextCell = document.querySelector(`[data-mo_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //កុំព្យូទ័រ
        if (sb == 'ICT') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var ict_m2semester = d.val().ict_m2semester;
                        if (!ict_m2semester) { ict_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}ict" contenteditable onclick="selectText(this)" data-ict_m2semester1="${N0}">${ict_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}ict`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ict`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ict_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_m2semester1);
                                    const nextCell = document.querySelector(`[data-ict_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_m2semester1);
                                    const nextCell = document.querySelector(`[data-ict_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ict_m2semester1);
                                    const nextCell = document.querySelector(`[data-ict_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_m2semester = d.val().math_m2semester;
                        if (!math_m2semester) { math_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_m2semester1="${N0}">${math_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m2semester1);
                                    const nextCell = document.querySelector(`[data-math_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m2semester1);
                                    const nextCell = document.querySelector(`[data-math_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m2semester1);
                                    const nextCell = document.querySelector(`[data-math_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_m2semester = d.val().k_m2semester;
                        var dic_m2semester = d.val().dic_m2semester;
                        var ke_m2semester = d.val().ke_m2semester;
                        if (!k_m2semester) { k_m2semester = 0 }
                        if (!dic_m2semester) { dic_m2semester = 0 }
                        if (!ke_m2semester) { ke_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>

                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k" contenteditable onclick="selectText(this)" data-k_m2semester1="${N0}">${k_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}dic_m2semester" contenteditable onclick="selectText(this)" data-dic_m2semester="${N0}">${dic_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}ke_m2semester" contenteditable onclick="selectText(this)" data-ke_m2semester="${N0}">${ke_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}dic_m2semester`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}dic_m2semester`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        dic_m2semester: d,
                                    });
                            })

                            document.getElementById(`${no_space}ke_m2semester`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}ke_m2semester`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        ke_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_m2semester1);
                                    const nextCell = document.querySelector(`[data-k_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.dic_m2semester);
                                    const nextCell = document.querySelector(`[data-dic_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.dic_m2semester);
                                    const nextCell = document.querySelector(`[data-dic_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.dic_m2semester);
                                    const nextCell = document.querySelector(`[data-dic_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ke_m2semester);
                                    const nextCell = document.querySelector(`[data-ke_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ke_m2semester);
                                    const nextCell = document.querySelector(`[data-ke_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.ke_m2semester);
                                    const nextCell = document.querySelector(`[data-ke_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_m2semester1);
                                    const nextCell = document.querySelector(`[data-k_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_m2semester1);
                                    const nextCell = document.querySelector(`[data-k_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_m2semester = d.val().hist_m2semester;
                        if (!hist_m2semester) { hist_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_m2semester1="${N0}">${hist_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m2semester1);
                                    const nextCell = document.querySelector(`[data-hist_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m2semester1);
                                    const nextCell = document.querySelector(`[data-hist_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m2semester1);
                                    const nextCell = document.querySelector(`[data-hist_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ផែនដីវិទ្យា
        if (sb == 'ES') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var earth_m2semester = d.val().earth_m2semester;
                        if (!earth_m2semester) { earth_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}earth" contenteditable onclick="selectText(this)" data-earth_m2semester1="${N0}">${earth_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}earth`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}earth`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        earth_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_m2semester1);
                                    const nextCell = document.querySelector(`[data-earth_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_m2semester1);
                                    const nextCell = document.querySelector(`[data-earth_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.earth_m2semester1);
                                    const nextCell = document.querySelector(`[data-earth_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_m2semester = d.val().geor_m2semester;
                        if (!geor_m2semester) { geor_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_m2semester1="${N0}">${geor_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m2semester1);
                                    const nextCell = document.querySelector(`[data-geor_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m2semester1);
                                    const nextCell = document.querySelector(`[data-geor_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m2semester1);
                                    const nextCell = document.querySelector(`[data-geor_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //រូបវិទ្យា
        if (sb == 'P') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var phy_m2semester = d.val().phy_m2semester;
                        if (!phy_m2semester) { phy_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}phy" contenteditable onclick="selectText(this)" data-phy_m2semester1="${N0}">${phy_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}phy`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}phy`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        phy_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_m2semester1);
                                    const nextCell = document.querySelector(`[data-phy_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_m2semester1);
                                    const nextCell = document.querySelector(`[data-phy_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.phy_m2semester1);
                                    const nextCell = document.querySelector(`[data-phy_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គីមីវិទ្យា
        if (sb == 'C') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var chem_m2semester = d.val().chem_m2semester;
                        if (!chem_m2semester) { chem_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}chem" contenteditable onclick="selectText(this)" data-chem_m2semester1="${N0}">${chem_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}chem`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}chem`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        chem_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_m2semester1);
                                    const nextCell = document.querySelector(`[data-chem_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_m2semester1);
                                    const nextCell = document.querySelector(`[data-chem_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.chem_m2semester1);
                                    const nextCell = document.querySelector(`[data-chem_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //គេហៈ
        if (sb == 'Ho') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hom_m2semester = d.val().hom_m2semester;
                        if (!hom_m2semester) { hom_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}hom" contenteditable onclick="selectText(this)" data-hom_m2semester1="${N0}">${hom_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hom`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hom`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hom_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_m2semester1);
                                    const nextCell = document.querySelector(`[data-hom_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_m2semester1);
                                    const nextCell = document.querySelector(`[data-hom_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hom_m2semester1);
                                    const nextCell = document.querySelector(`[data-hom_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //សេដ្ឋកិច្ច
        if (sb == 'Eco') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var eco_m2semester = d.val().eco_m2semester;
                        if (!eco_m2semester) { eco_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}eco" contenteditable onclick="selectText(this)" data-eco_m2semester1="${N0}">${eco_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}eco`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}eco`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        eco_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_m2semester1);
                                    const nextCell = document.querySelector(`[data-eco_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_m2semester1);
                                    const nextCell = document.querySelector(`[data-eco_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.eco_m2semester1);
                                    const nextCell = document.querySelector(`[data-eco_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

        //ជីវៈវិទ្យា
        if (sb == 'Bio') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var bio_m2semester = d.val().bio_m2semester;
                        if (!bio_m2semester) { bio_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}bio" contenteditable onclick="selectText(this)" data-bio_m2semester="${N0}">${bio_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (millisbionds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, millisbionds);
                            });
                            document.getElementById(`${no_space}bio`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}bio`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        bio_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_m2semester);
                                    const nextCell = document.querySelector(`[data-bio_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_m2semester);
                                    const nextCell = document.querySelector(`[data-bio_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.bio_m2semester);
                                    const nextCell = document.querySelector(`[data-bio_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }

    }

}