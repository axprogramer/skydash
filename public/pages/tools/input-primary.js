const firebaseConfig = {
    apiKey: "AIzaSyDn5l50utUfCEBpWEYX_lQO5Ar3OB0WAmc",
    authDomain: "salamom-d3246.firebaseapp.com",
    databaseURL: "https://salamom-d3246-default-rtdb.firebaseio.com",
    projectId: "salamom-d3246",
    storageBucket: "salamom-d3246.appspot.com",
    messagingSenderId: "521352537338",
    appId: "1:521352537338:web:fbccf858c76c4a843d1543"
};
firebase.initializeApp(firebaseConfig);

var user_login_name = localStorage.getItem('setName');
var user_login_subs = localStorage.getItem('setSubs');
var user_login_year = localStorage.getItem('setYear');
var user_month = localStorage.getItem('input_month');
var user_url = localStorage.getItem('user_url');
var user_img = document.getElementById('user_img');
if (user_url) {
    user_img.src = user_url;
}
var get_subs = localStorage.getItem('set_to_get_subs');
//Convert En to KH
var month = '';
var show_month = '';

var table = document.getElementById('show_hearder')
var tbody_data = document.getElementById('show_footer')
if (get_subs) {
    var [s] = get_subs.substring(0, 3).split(" ");
    var [sb] = get_subs.substring(4, 10).split(" ");
}
let grade = '';
let grade_kh = '';
//Grade in EN
if (s == '01A') { grade = '1A' };
if (s == '02A') { grade = '2A' };
if (s == '03A') { grade = '3A' };
if (s == '04A') { grade = '4A' };
if (s == '05A') { grade = '5A' };
if (s == '06A') { grade = '6A' };
if (s == '07A') { grade = '7A' };
if (s == '08A') { grade = '8A' };
if (s == '09A') { grade = '9A' };
if (s == '10A') { grade = '10A' };
if (s == '11A') { grade = '11A' };
if (s == '12A') { grade = '12A' };

if (s == '01B') { grade = '1B' };
if (s == '02B') { grade = '2B' };
if (s == '03B') { grade = '3B' };
if (s == '04B') { grade = '4B' };
if (s == '05B') { grade = '5B' };
if (s == '06B') { grade = '6B' };
if (s == '07B') { grade = '7B' };
if (s == '08B') { grade = '8B' };
if (s == '09B') { grade = '9B' };
if (s == '10B') { grade = '10B' };
if (s == '11B') { grade = '11B' };
if (s == '12B') { grade = '12B' };

if (s == '01C') { grade = '1C' };
if (s == '02C') { grade = '2C' };
if (s == '03C') { grade = '3C' };
if (s == '04C') { grade = '4C' };
if (s == '05C') { grade = '5C' };
if (s == '06C') { grade = '6C' };
if (s == '07C') { grade = '7C' };
if (s == '08C') { grade = '8C' };
if (s == '09C') { grade = '9C' };
if (s == '10C') { grade = '10C' };
if (s == '10C') { grade = '10C' };
if (s == '11C') { grade = '11C' };
if (s == '12C') { grade = '12C' };
//Grade in Kh
if (grade == '1A') { grade_kh = '១ក' };
if (grade == '2A') { grade_kh = '២ក' };
if (grade == '3A') { grade_kh = '៣ក' };
if (grade == '4A') { grade_kh = '៤ក' };
if (grade == '5A') { grade_kh = '៥ក' };
if (grade == '6A') { grade_kh = '៦ក' };
if (grade == '7A') { grade_kh = '៧ក' };
if (grade == '8A') { grade_kh = '៨ក' };
if (grade == '9A') { grade_kh = '៩ក' };
if (grade == '10A') { grade_kh = '១០ក' };
if (grade == '11A') { grade_kh = '១១ក' };
if (grade == '12A') { grade_kh = '១២ក' };

if (grade == '1B') { grade_kh = '១ខ' };
if (grade == '2B') { grade_kh = '២ខ' };
if (grade == '3B') { grade_kh = '៣ខ' };
if (grade == '4B') { grade_kh = '៤ខ' };
if (grade == '5B') { grade_kh = '៥ខ' };
if (grade == '6B') { grade_kh = '៦ខ' };
if (grade == '7B') { grade_kh = '៧ខ' };
if (grade == '8B') { grade_kh = '៨ខ' };
if (grade == '9B') { grade_kh = '៩ខ' };
if (grade == '10B') { grade_kh = '១០ខ' };
if (grade == '10C') { grade_kh = '១០គ' };
if (grade == '11B') { grade_kh = '១១ខ' };
if (grade == '12B') { grade_kh = '១២ខ' };

if (grade == '1C') { grade_kh = '១គ' };
if (grade == '2C') { grade_kh = '២គ' };
if (grade == '3C') { grade_kh = '៣គ' };
if (grade == '4C') { grade_kh = '៤គ' };
if (grade == '5C') { grade_kh = '៥គ' };
if (grade == '6C') { grade_kh = '៦គ' };
if (grade == '7C') { grade_kh = '៧គ' };
if (grade == '8C') { grade_kh = '៨គ' };
if (grade == '9C') { grade_kh = '៩គ' };
if (grade == '10C') { grade_kh = '១០គ' };
if (grade == '11C') { grade_kh = '១១គ' };
if (grade == '12C') { grade_kh = '១២គ' };

document.getElementById('grade_title').innerHTML = grade_kh;
let sub = '';
if (sb == 'PE') { sub = 'កីឡា' }
if (sb == 'E') { sub = 'ភាសាអង់គ្លេស' }
if (sb == 'ICT') { sub = 'កុំព្យូទ័រ' }
if (sb == 'M') { sub = 'គណិតវិទ្យា' }
if (sb == 'C') { sub = 'គីមីវិទ្យា' }
if (sb == 'Ho') { sub = 'គេហៈ' }
if (sb == 'Bio') { sub = 'ជីវៈវិទ្យា' }
if (sb == 'H') { sub = 'ប្រវត្តិវិទ្យា' }
if (sb == 'ES') { sub = 'ផែនដីវិទ្យា' }
if (sb == 'G') { sub = 'ភូមិវិទ្យា' }
if (sb == 'P') { sub = 'រូបវិទ្យា' }
if (sb == 'Ac') { sub = 'សកម្មភាព' }
if (sb == 'Bi') { sub = 'សិក្សាសីលធម៌' }
if (sb == 'Mo') { sub = 'សីលធម៌-ពលរដ្ឋ' }
if (sb == 'Eco') { sub = 'សេដ្ឋកិច្ច' }
if (sb == 'K') { sub = 'ភាសាខ្មែរ' }
if (sb == 'Sci') { sub = 'វិទ្យាសាស្ត្រ' }
if (sb == 'Soc') { sub = 'សិក្សាសង្គម' }
var N0 = '';
export function primaryInput() {
    // ខែតុលា
    if (user_month == 'October') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_moct = d.val().e_moct;
                        var e_h_moct = d.val().e_h_moct;
                        if (!e_moct) { e_moct = 0 }
                        if (!e_h_moct) { e_h_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_moct1="${N0}">${e_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_moct2="${N0}">${e_h_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct1);
                                    const nextCell = document.querySelector(`[data-e_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct1);
                                    const nextCell = document.querySelector(`[data-e_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct1);
                                    const nextCell = document.querySelector(`[data-e_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct2);
                                    const nextCell = document.querySelector(`[data-e_moct2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct2);
                                    const nextCell = document.querySelector(`[data-e_moct2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_moct2);
                                    const nextCell = document.querySelector(`[data-e_moct2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_moct = d.val().pe_moct;
                        if (!pe_moct) { pe_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_moct1="${N0}">${pe_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_moct: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_moct1);
                                    const nextCell = document.querySelector(`[data-pe_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_moct1);
                                    const nextCell = document.querySelector(`[data-pe_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_moct1);
                                    const nextCell = document.querySelector(`[data-pe_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_moct = d.val().k_listen_moct;
                        var k_speak_moct = d.val().k_speak_moct;
                        var k_reading_moct = d.val().k_reading_moct;
                        var k_dictation_moct = d.val().k_dictation_moct;
                        var k_writing_moct = d.val().k_writing_moct;
                        var k_grammar_moct = d.val().k_grammar_moct;
                        var k_homework_moct = d.val().k_homework_moct;
                        if (!k_listen_moct) { k_listen_moct = 0 }
                        if (!k_speak_moct) { k_speak_moct = 0 }
                        if (!k_reading_moct) { k_reading_moct = 0 }
                        if (!k_writing_moct) { k_writing_moct = 0 }
                        if (!k_homework_moct) { k_homework_moct = 0 }
                        if (!k_grammar_moct) { k_grammar_moct = 0 }
                        if (!k_dictation_moct) { k_dictation_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_moct="${N0}">${k_listen_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_moct="${N0}">${k_speak_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_moct="${N0}">${k_reading_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_moct="${N0}">${k_dictation_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_moct="${N0}">${k_writing_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_moct="${N0}">${k_grammar_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_moct="${N0}">${k_homework_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_moct: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_moct);
                                    const nextCell = document.querySelector(`[data-k_grammar_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_moct);
                                    const nextCell = document.querySelector(`[data-k_grammar_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_moct);
                                    const nextCell = document.querySelector(`[data-k_grammar_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_moct);
                                    const nextCell = document.querySelector(`[data-k_listen_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_moct);
                                    const nextCell = document.querySelector(`[data-k_listen_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_moct);
                                    const nextCell = document.querySelector(`[data-k_listen_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_moct);
                                    const nextCell = document.querySelector(`[data-k_speak_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_moct);
                                    const nextCell = document.querySelector(`[data-k_speak_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_moct);
                                    const nextCell = document.querySelector(`[data-k_speak_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_moct);
                                    const nextCell = document.querySelector(`[data-k_reading_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_moct);
                                    const nextCell = document.querySelector(`[data-k_reading_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_moct);
                                    const nextCell = document.querySelector(`[data-k_reading_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_moct);
                                    const nextCell = document.querySelector(`[data-k_dictation_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_moct);
                                    const nextCell = document.querySelector(`[data-k_dictation_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_moct);
                                    const nextCell = document.querySelector(`[data-k_dictation_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_moct);
                                    const nextCell = document.querySelector(`[data-k_writing_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_moct);
                                    const nextCell = document.querySelector(`[data-k_writing_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_moct);
                                    const nextCell = document.querySelector(`[data-k_writing_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_moct);
                                    const nextCell = document.querySelector(`[data-k_homework_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_moct);
                                    const nextCell = document.querySelector(`[data-k_homework_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_moct);
                                    const nextCell = document.querySelector(`[data-k_homework_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_moct = d.val().math_moct;
                        var math_h_moct = d.val().math_h_moct;
                        var math_speak_moct = d.val().math_speak_moct;
                        if (!math_moct) { math_moct = 0 }
                        if (!math_h_moct) { math_h_moct = 0 }
                        if (!math_speak_moct) { math_speak_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_moct1="${N0}">${math_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_moct="${N0}">${math_h_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_moct="${N0}">${math_speak_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_moct: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_moct1);
                                    const nextCell = document.querySelector(`[data-math_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_moct1);
                                    const nextCell = document.querySelector(`[data-math_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_moct1);
                                    const nextCell = document.querySelector(`[data-math_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_moct);
                                    const nextCell = document.querySelector(`[data-math_h_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_moct);
                                    const nextCell = document.querySelector(`[data-math_h_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_moct);
                                    const nextCell = document.querySelector(`[data-math_h_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_moct);
                                    const nextCell = document.querySelector(`[data-math_speak_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_moct);
                                    const nextCell = document.querySelector(`[data-math_speak_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_moct);
                                    const nextCell = document.querySelector(`[data-math_speak_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_moct = d.val().sci_moct;
                        var sci_h_moct = d.val().sci_h_moct;
                        if (!sci_moct) { sci_moct = 0 }
                        if (!sci_h_moct) { sci_h_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_moct1="${N0}">${sci_moct}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_moct="${N0}">${sci_h_moct}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_moct: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_moct1);
                                    const nextCell = document.querySelector(`[data-sci_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_moct1);
                                    const nextCell = document.querySelector(`[data-sci_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_moct1);
                                    const nextCell = document.querySelector(`[data-sci_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_moct);
                                    const nextCell = document.querySelector(`[data-sci_h_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_moct);
                                    const nextCell = document.querySelector(`[data-sci_h_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_moct);
                                    const nextCell = document.querySelector(`[data-sci_h_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_moct = d.val().soc_moct;
                        var soc_h_moct = d.val().soc_h_moct;
                        if (!soc_moct) { soc_moct = 0 }
                        if (!soc_h_moct) { soc_h_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_moct1="${N0}">${soc_moct}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_moct="${N0}">${soc_h_moct}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_moct: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_moct: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_moct1);
                                    const nextCell = document.querySelector(`[data-soc_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_moct1);
                                    const nextCell = document.querySelector(`[data-soc_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_moct1);
                                    const nextCell = document.querySelector(`[data-soc_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_moct);
                                    const nextCell = document.querySelector(`[data-soc_h_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_moct);
                                    const nextCell = document.querySelector(`[data-soc_h_moct="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_moct);
                                    const nextCell = document.querySelector(`[data-soc_h_moct="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_moct = d.val().geor_moct;
                        if (!geor_moct) { geor_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_moct1="${N0}">${geor_moct}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_moct: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_moct1);
                                    const nextCell = document.querySelector(`[data-geor_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_moct1);
                                    const nextCell = document.querySelector(`[data-geor_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_moct1);
                                    const nextCell = document.querySelector(`[data-geor_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_moct = d.val().hist_moct;
                        if (!hist_moct) { hist_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_moct1="${N0}">${hist_moct}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_moct: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_moct1);
                                    const nextCell = document.querySelector(`[data-hist_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_moct1);
                                    const nextCell = document.querySelector(`[data-hist_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_moct1);
                                    const nextCell = document.querySelector(`[data-hist_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_moct = d.val().moral_moct;
                        if (!moral_moct) { moral_moct = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_moct1="${N0}">${moral_moct}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_moct: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_moct1);
                                    const nextCell = document.querySelector(`[data-moral_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_moct1);
                                    const nextCell = document.querySelector(`[data-moral_moct1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_moct1);
                                    const nextCell = document.querySelector(`[data-moral_moct1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែវិច្ឆិកា
    if (user_month == 'November') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mnov = d.val().e_mnov;
                        var e_h_mnov = d.val().e_h_mnov;
                        if (!e_mnov) { e_mnov = 0 }
                        if (!e_h_mnov) { e_h_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mnov1="${N0}">${e_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mnov2="${N0}">${e_h_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov1);
                                    const nextCell = document.querySelector(`[data-e_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov1);
                                    const nextCell = document.querySelector(`[data-e_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov1);
                                    const nextCell = document.querySelector(`[data-e_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov2);
                                    const nextCell = document.querySelector(`[data-e_mnov2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov2);
                                    const nextCell = document.querySelector(`[data-e_mnov2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mnov2);
                                    const nextCell = document.querySelector(`[data-e_mnov2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mnov = d.val().pe_mnov;
                        if (!pe_mnov) { pe_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mnov1="${N0}">${pe_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mnov: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mnov1);
                                    const nextCell = document.querySelector(`[data-pe_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mnov1);
                                    const nextCell = document.querySelector(`[data-pe_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mnov1);
                                    const nextCell = document.querySelector(`[data-pe_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mnov = d.val().k_listen_mnov;
                        var k_speak_mnov = d.val().k_speak_mnov;
                        var k_reading_mnov = d.val().k_reading_mnov;
                        var k_dictation_mnov = d.val().k_dictation_mnov;
                        var k_writing_mnov = d.val().k_writing_mnov;
                        var k_grammar_mnov = d.val().k_grammar_mnov;
                        var k_homework_mnov = d.val().k_homework_mnov;
                        if (!k_listen_mnov) { k_listen_mnov = 0 }
                        if (!k_speak_mnov) { k_speak_mnov = 0 }
                        if (!k_reading_mnov) { k_reading_mnov = 0 }
                        if (!k_writing_mnov) { k_writing_mnov = 0 }
                        if (!k_homework_mnov) { k_homework_mnov = 0 }
                        if (!k_grammar_mnov) { k_grammar_mnov = 0 }
                        if (!k_dictation_mnov) { k_dictation_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mnov="${N0}">${k_listen_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mnov="${N0}">${k_speak_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mnov="${N0}">${k_reading_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mnov="${N0}">${k_dictation_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mnov="${N0}">${k_writing_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mnov="${N0}">${k_grammar_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mnov="${N0}">${k_homework_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mnov: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mnov);
                                    const nextCell = document.querySelector(`[data-k_grammar_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mnov);
                                    const nextCell = document.querySelector(`[data-k_grammar_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mnov);
                                    const nextCell = document.querySelector(`[data-k_grammar_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mnov);
                                    const nextCell = document.querySelector(`[data-k_listen_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mnov);
                                    const nextCell = document.querySelector(`[data-k_listen_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mnov);
                                    const nextCell = document.querySelector(`[data-k_listen_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mnov);
                                    const nextCell = document.querySelector(`[data-k_speak_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mnov);
                                    const nextCell = document.querySelector(`[data-k_speak_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mnov);
                                    const nextCell = document.querySelector(`[data-k_speak_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mnov);
                                    const nextCell = document.querySelector(`[data-k_reading_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mnov);
                                    const nextCell = document.querySelector(`[data-k_reading_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mnov);
                                    const nextCell = document.querySelector(`[data-k_reading_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mnov);
                                    const nextCell = document.querySelector(`[data-k_dictation_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mnov);
                                    const nextCell = document.querySelector(`[data-k_dictation_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mnov);
                                    const nextCell = document.querySelector(`[data-k_dictation_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mnov);
                                    const nextCell = document.querySelector(`[data-k_writing_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mnov);
                                    const nextCell = document.querySelector(`[data-k_writing_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mnov);
                                    const nextCell = document.querySelector(`[data-k_writing_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mnov);
                                    const nextCell = document.querySelector(`[data-k_homework_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mnov);
                                    const nextCell = document.querySelector(`[data-k_homework_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mnov);
                                    const nextCell = document.querySelector(`[data-k_homework_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mnov = d.val().math_mnov;
                        var math_h_mnov = d.val().math_h_mnov;
                        var math_speak_mnov = d.val().math_speak_mnov;
                        if (!math_mnov) { math_mnov = 0 }
                        if (!math_h_mnov) { math_h_mnov = 0 }
                        if (!math_speak_mnov) { math_speak_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mnov1="${N0}">${math_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mnov="${N0}">${math_h_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mnov="${N0}">${math_speak_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mnov: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mnov1);
                                    const nextCell = document.querySelector(`[data-math_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mnov1);
                                    const nextCell = document.querySelector(`[data-math_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mnov1);
                                    const nextCell = document.querySelector(`[data-math_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mnov);
                                    const nextCell = document.querySelector(`[data-math_h_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mnov);
                                    const nextCell = document.querySelector(`[data-math_h_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mnov);
                                    const nextCell = document.querySelector(`[data-math_h_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mnov);
                                    const nextCell = document.querySelector(`[data-math_speak_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mnov);
                                    const nextCell = document.querySelector(`[data-math_speak_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mnov);
                                    const nextCell = document.querySelector(`[data-math_speak_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mnov = d.val().sci_mnov;
                        var sci_h_mnov = d.val().sci_h_mnov;
                        if (!sci_mnov) { sci_mnov = 0 }
                        if (!sci_h_mnov) { sci_h_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mnov1="${N0}">${sci_mnov}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mnov="${N0}">${sci_h_mnov}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mnov: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mnov1);
                                    const nextCell = document.querySelector(`[data-sci_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mnov1);
                                    const nextCell = document.querySelector(`[data-sci_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mnov1);
                                    const nextCell = document.querySelector(`[data-sci_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mnov);
                                    const nextCell = document.querySelector(`[data-sci_h_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mnov);
                                    const nextCell = document.querySelector(`[data-sci_h_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mnov);
                                    const nextCell = document.querySelector(`[data-sci_h_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mnov = d.val().soc_mnov;
                        var soc_h_mnov = d.val().soc_h_mnov;
                        if (!soc_mnov) { soc_mnov = 0 }
                        if (!soc_h_mnov) { soc_h_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mnov1="${N0}">${soc_mnov}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mnov="${N0}">${soc_h_mnov}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mnov: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mnov: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mnov1);
                                    const nextCell = document.querySelector(`[data-soc_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mnov1);
                                    const nextCell = document.querySelector(`[data-soc_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mnov1);
                                    const nextCell = document.querySelector(`[data-soc_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mnov);
                                    const nextCell = document.querySelector(`[data-soc_h_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mnov);
                                    const nextCell = document.querySelector(`[data-soc_h_mnov="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mnov);
                                    const nextCell = document.querySelector(`[data-soc_h_mnov="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mnov = d.val().geor_mnov;
                        if (!geor_mnov) { geor_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mnov1="${N0}">${geor_mnov}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mnov: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mnov1);
                                    const nextCell = document.querySelector(`[data-geor_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mnov1);
                                    const nextCell = document.querySelector(`[data-geor_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mnov1);
                                    const nextCell = document.querySelector(`[data-geor_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mnov = d.val().hist_mnov;
                        if (!hist_mnov) { hist_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mnov1="${N0}">${hist_mnov}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mnov: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mnov1);
                                    const nextCell = document.querySelector(`[data-hist_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mnov1);
                                    const nextCell = document.querySelector(`[data-hist_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mnov1);
                                    const nextCell = document.querySelector(`[data-hist_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mnov = d.val().moral_mnov;
                        if (!moral_mnov) { moral_mnov = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mnov1="${N0}">${moral_mnov}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mnov: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mnov1);
                                    const nextCell = document.querySelector(`[data-moral_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mnov1);
                                    const nextCell = document.querySelector(`[data-moral_mnov1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mnov1);
                                    const nextCell = document.querySelector(`[data-moral_mnov1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែធ្នូ
    if (user_month == 'December') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mdec = d.val().e_mdec;
                        var e_h_mdec = d.val().e_h_mdec;
                        if (!e_mdec) { e_mdec = 0 }
                        if (!e_h_mdec) { e_h_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mdec1="${N0}">${e_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mdec2="${N0}">${e_h_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec1);
                                    const nextCell = document.querySelector(`[data-e_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec1);
                                    const nextCell = document.querySelector(`[data-e_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec1);
                                    const nextCell = document.querySelector(`[data-e_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec2);
                                    const nextCell = document.querySelector(`[data-e_mdec2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec2);
                                    const nextCell = document.querySelector(`[data-e_mdec2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mdec2);
                                    const nextCell = document.querySelector(`[data-e_mdec2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mdec = d.val().pe_mdec;
                        if (!pe_mdec) { pe_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mdec1="${N0}">${pe_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mdec: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mdec1);
                                    const nextCell = document.querySelector(`[data-pe_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mdec1);
                                    const nextCell = document.querySelector(`[data-pe_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mdec1);
                                    const nextCell = document.querySelector(`[data-pe_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mdec = d.val().k_listen_mdec;
                        var k_speak_mdec = d.val().k_speak_mdec;
                        var k_reading_mdec = d.val().k_reading_mdec;
                        var k_dictation_mdec = d.val().k_dictation_mdec;
                        var k_writing_mdec = d.val().k_writing_mdec;
                        var k_grammar_mdec = d.val().k_grammar_mdec;
                        var k_homework_mdec = d.val().k_homework_mdec;
                        if (!k_listen_mdec) { k_listen_mdec = 0 }
                        if (!k_speak_mdec) { k_speak_mdec = 0 }
                        if (!k_reading_mdec) { k_reading_mdec = 0 }
                        if (!k_writing_mdec) { k_writing_mdec = 0 }
                        if (!k_homework_mdec) { k_homework_mdec = 0 }
                        if (!k_grammar_mdec) { k_grammar_mdec = 0 }
                        if (!k_dictation_mdec) { k_dictation_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mdec="${N0}">${k_listen_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mdec="${N0}">${k_speak_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mdec="${N0}">${k_reading_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mdec="${N0}">${k_dictation_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mdec="${N0}">${k_writing_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mdec="${N0}">${k_grammar_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mdec="${N0}">${k_homework_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mdec: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mdec);
                                    const nextCell = document.querySelector(`[data-k_grammar_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mdec);
                                    const nextCell = document.querySelector(`[data-k_grammar_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mdec);
                                    const nextCell = document.querySelector(`[data-k_grammar_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mdec);
                                    const nextCell = document.querySelector(`[data-k_listen_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mdec);
                                    const nextCell = document.querySelector(`[data-k_listen_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mdec);
                                    const nextCell = document.querySelector(`[data-k_listen_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mdec);
                                    const nextCell = document.querySelector(`[data-k_speak_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mdec);
                                    const nextCell = document.querySelector(`[data-k_speak_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mdec);
                                    const nextCell = document.querySelector(`[data-k_speak_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mdec);
                                    const nextCell = document.querySelector(`[data-k_reading_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mdec);
                                    const nextCell = document.querySelector(`[data-k_reading_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mdec);
                                    const nextCell = document.querySelector(`[data-k_reading_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mdec);
                                    const nextCell = document.querySelector(`[data-k_dictation_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mdec);
                                    const nextCell = document.querySelector(`[data-k_dictation_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mdec);
                                    const nextCell = document.querySelector(`[data-k_dictation_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mdec);
                                    const nextCell = document.querySelector(`[data-k_writing_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mdec);
                                    const nextCell = document.querySelector(`[data-k_writing_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mdec);
                                    const nextCell = document.querySelector(`[data-k_writing_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mdec);
                                    const nextCell = document.querySelector(`[data-k_homework_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mdec);
                                    const nextCell = document.querySelector(`[data-k_homework_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mdec);
                                    const nextCell = document.querySelector(`[data-k_homework_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mdec = d.val().math_mdec;
                        var math_h_mdec = d.val().math_h_mdec;
                        var math_speak_mdec = d.val().math_speak_mdec;
                        if (!math_mdec) { math_mdec = 0 }
                        if (!math_h_mdec) { math_h_mdec = 0 }
                        if (!math_speak_mdec) { math_speak_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mdec1="${N0}">${math_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mdec="${N0}">${math_h_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mdec="${N0}">${math_speak_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mdec: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mdec1);
                                    const nextCell = document.querySelector(`[data-math_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mdec1);
                                    const nextCell = document.querySelector(`[data-math_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mdec1);
                                    const nextCell = document.querySelector(`[data-math_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mdec);
                                    const nextCell = document.querySelector(`[data-math_h_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mdec);
                                    const nextCell = document.querySelector(`[data-math_h_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mdec);
                                    const nextCell = document.querySelector(`[data-math_h_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mdec);
                                    const nextCell = document.querySelector(`[data-math_speak_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mdec);
                                    const nextCell = document.querySelector(`[data-math_speak_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mdec);
                                    const nextCell = document.querySelector(`[data-math_speak_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mdec = d.val().sci_mdec;
                        var sci_h_mdec = d.val().sci_h_mdec;
                        if (!sci_mdec) { sci_mdec = 0 }
                        if (!sci_h_mdec) { sci_h_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mdec1="${N0}">${sci_mdec}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mdec="${N0}">${sci_h_mdec}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mdec: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mdec1);
                                    const nextCell = document.querySelector(`[data-sci_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mdec1);
                                    const nextCell = document.querySelector(`[data-sci_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mdec1);
                                    const nextCell = document.querySelector(`[data-sci_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mdec);
                                    const nextCell = document.querySelector(`[data-sci_h_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mdec);
                                    const nextCell = document.querySelector(`[data-sci_h_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mdec);
                                    const nextCell = document.querySelector(`[data-sci_h_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mdec = d.val().soc_mdec;
                        var soc_h_mdec = d.val().soc_h_mdec;
                        if (!soc_mdec) { soc_mdec = 0 }
                        if (!soc_h_mdec) { soc_h_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mdec1="${N0}">${soc_mdec}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mdec="${N0}">${soc_h_mdec}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mdec: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mdec: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mdec1);
                                    const nextCell = document.querySelector(`[data-soc_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mdec1);
                                    const nextCell = document.querySelector(`[data-soc_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mdec1);
                                    const nextCell = document.querySelector(`[data-soc_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mdec);
                                    const nextCell = document.querySelector(`[data-soc_h_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mdec);
                                    const nextCell = document.querySelector(`[data-soc_h_mdec="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mdec);
                                    const nextCell = document.querySelector(`[data-soc_h_mdec="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mdec = d.val().geor_mdec;
                        if (!geor_mdec) { geor_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mdec1="${N0}">${geor_mdec}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mdec: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mdec1);
                                    const nextCell = document.querySelector(`[data-geor_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mdec1);
                                    const nextCell = document.querySelector(`[data-geor_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mdec1);
                                    const nextCell = document.querySelector(`[data-geor_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mdec = d.val().hist_mdec;
                        if (!hist_mdec) { hist_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mdec1="${N0}">${hist_mdec}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mdec: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mdec1);
                                    const nextCell = document.querySelector(`[data-hist_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mdec1);
                                    const nextCell = document.querySelector(`[data-hist_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mdec1);
                                    const nextCell = document.querySelector(`[data-hist_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mdec = d.val().moral_mdec;
                        if (!moral_mdec) { moral_mdec = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mdec1="${N0}">${moral_mdec}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mdec: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mdec1);
                                    const nextCell = document.querySelector(`[data-moral_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mdec1);
                                    const nextCell = document.querySelector(`[data-moral_mdec1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mdec1);
                                    const nextCell = document.querySelector(`[data-moral_mdec1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែមករា
    if (user_month == 'January') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mjan = d.val().e_mjan;
                        var e_h_mjan = d.val().e_h_mjan;
                        if (!e_mjan) { e_mjan = 0 }
                        if (!e_h_mjan) { e_h_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mjan1="${N0}">${e_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mjan2="${N0}">${e_h_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan1);
                                    const nextCell = document.querySelector(`[data-e_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan1);
                                    const nextCell = document.querySelector(`[data-e_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan1);
                                    const nextCell = document.querySelector(`[data-e_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan2);
                                    const nextCell = document.querySelector(`[data-e_mjan2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan2);
                                    const nextCell = document.querySelector(`[data-e_mjan2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjan2);
                                    const nextCell = document.querySelector(`[data-e_mjan2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mjan = d.val().pe_mjan;
                        if (!pe_mjan) { pe_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mjan1="${N0}">${pe_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mjan: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjan1);
                                    const nextCell = document.querySelector(`[data-pe_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjan1);
                                    const nextCell = document.querySelector(`[data-pe_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjan1);
                                    const nextCell = document.querySelector(`[data-pe_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mjan = d.val().k_listen_mjan;
                        var k_speak_mjan = d.val().k_speak_mjan;
                        var k_reading_mjan = d.val().k_reading_mjan;
                        var k_dictation_mjan = d.val().k_dictation_mjan;
                        var k_writing_mjan = d.val().k_writing_mjan;
                        var k_grammar_mjan = d.val().k_grammar_mjan;
                        var k_homework_mjan = d.val().k_homework_mjan;
                        if (!k_listen_mjan) { k_listen_mjan = 0 }
                        if (!k_speak_mjan) { k_speak_mjan = 0 }
                        if (!k_reading_mjan) { k_reading_mjan = 0 }
                        if (!k_writing_mjan) { k_writing_mjan = 0 }
                        if (!k_homework_mjan) { k_homework_mjan = 0 }
                        if (!k_grammar_mjan) { k_grammar_mjan = 0 }
                        if (!k_dictation_mjan) { k_dictation_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mjan="${N0}">${k_listen_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mjan="${N0}">${k_speak_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mjan="${N0}">${k_reading_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mjan="${N0}">${k_dictation_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mjan="${N0}">${k_writing_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mjan="${N0}">${k_grammar_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mjan="${N0}">${k_homework_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mjan: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjan);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjan);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjan);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjan);
                                    const nextCell = document.querySelector(`[data-k_listen_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjan);
                                    const nextCell = document.querySelector(`[data-k_listen_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjan);
                                    const nextCell = document.querySelector(`[data-k_listen_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjan);
                                    const nextCell = document.querySelector(`[data-k_speak_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjan);
                                    const nextCell = document.querySelector(`[data-k_speak_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjan);
                                    const nextCell = document.querySelector(`[data-k_speak_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjan);
                                    const nextCell = document.querySelector(`[data-k_reading_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjan);
                                    const nextCell = document.querySelector(`[data-k_reading_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjan);
                                    const nextCell = document.querySelector(`[data-k_reading_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjan);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjan);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjan);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjan);
                                    const nextCell = document.querySelector(`[data-k_writing_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjan);
                                    const nextCell = document.querySelector(`[data-k_writing_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjan);
                                    const nextCell = document.querySelector(`[data-k_writing_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjan);
                                    const nextCell = document.querySelector(`[data-k_homework_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjan);
                                    const nextCell = document.querySelector(`[data-k_homework_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjan);
                                    const nextCell = document.querySelector(`[data-k_homework_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mjan = d.val().math_mjan;
                        var math_h_mjan = d.val().math_h_mjan;
                        var math_speak_mjan = d.val().math_speak_mjan;
                        if (!math_mjan) { math_mjan = 0 }
                        if (!math_h_mjan) { math_h_mjan = 0 }
                        if (!math_speak_mjan) { math_speak_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mjan1="${N0}">${math_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mjan="${N0}">${math_h_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mjan="${N0}">${math_speak_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mjan: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjan1);
                                    const nextCell = document.querySelector(`[data-math_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjan1);
                                    const nextCell = document.querySelector(`[data-math_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjan1);
                                    const nextCell = document.querySelector(`[data-math_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjan);
                                    const nextCell = document.querySelector(`[data-math_h_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjan);
                                    const nextCell = document.querySelector(`[data-math_h_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjan);
                                    const nextCell = document.querySelector(`[data-math_h_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjan);
                                    const nextCell = document.querySelector(`[data-math_speak_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjan);
                                    const nextCell = document.querySelector(`[data-math_speak_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjan);
                                    const nextCell = document.querySelector(`[data-math_speak_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mjan = d.val().sci_mjan;
                        var sci_h_mjan = d.val().sci_h_mjan;
                        if (!sci_mjan) { sci_mjan = 0 }
                        if (!sci_h_mjan) { sci_h_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mjan1="${N0}">${sci_mjan}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mjan="${N0}">${sci_h_mjan}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mjan: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjan1);
                                    const nextCell = document.querySelector(`[data-sci_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjan1);
                                    const nextCell = document.querySelector(`[data-sci_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjan1);
                                    const nextCell = document.querySelector(`[data-sci_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjan);
                                    const nextCell = document.querySelector(`[data-sci_h_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjan);
                                    const nextCell = document.querySelector(`[data-sci_h_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjan);
                                    const nextCell = document.querySelector(`[data-sci_h_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mjan = d.val().soc_mjan;
                        var soc_h_mjan = d.val().soc_h_mjan;
                        if (!soc_mjan) { soc_mjan = 0 }
                        if (!soc_h_mjan) { soc_h_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mjan1="${N0}">${soc_mjan}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mjan="${N0}">${soc_h_mjan}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mjan: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mjan: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjan1);
                                    const nextCell = document.querySelector(`[data-soc_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjan1);
                                    const nextCell = document.querySelector(`[data-soc_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjan1);
                                    const nextCell = document.querySelector(`[data-soc_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjan);
                                    const nextCell = document.querySelector(`[data-soc_h_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjan);
                                    const nextCell = document.querySelector(`[data-soc_h_mjan="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjan);
                                    const nextCell = document.querySelector(`[data-soc_h_mjan="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mjan = d.val().geor_mjan;
                        if (!geor_mjan) { geor_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mjan1="${N0}">${geor_mjan}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mjan: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjan1);
                                    const nextCell = document.querySelector(`[data-geor_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjan1);
                                    const nextCell = document.querySelector(`[data-geor_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjan1);
                                    const nextCell = document.querySelector(`[data-geor_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mjan = d.val().hist_mjan;
                        if (!hist_mjan) { hist_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mjan1="${N0}">${hist_mjan}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mjan: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjan1);
                                    const nextCell = document.querySelector(`[data-hist_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjan1);
                                    const nextCell = document.querySelector(`[data-hist_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjan1);
                                    const nextCell = document.querySelector(`[data-hist_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mjan = d.val().moral_mjan;
                        if (!moral_mjan) { moral_mjan = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mjan1="${N0}">${moral_mjan}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mjan: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjan1);
                                    const nextCell = document.querySelector(`[data-moral_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjan1);
                                    const nextCell = document.querySelector(`[data-moral_mjan1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjan1);
                                    const nextCell = document.querySelector(`[data-moral_mjan1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែកុម្ភៈ
    if (user_month == 'February') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mfeb = d.val().e_mfeb;
                        var e_h_mfeb = d.val().e_h_mfeb;
                        if (!e_mfeb) { e_mfeb = 0 }
                        if (!e_h_mfeb) { e_h_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mfeb1="${N0}">${e_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mfeb2="${N0}">${e_h_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb1);
                                    const nextCell = document.querySelector(`[data-e_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb1);
                                    const nextCell = document.querySelector(`[data-e_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb1);
                                    const nextCell = document.querySelector(`[data-e_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb2);
                                    const nextCell = document.querySelector(`[data-e_mfeb2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb2);
                                    const nextCell = document.querySelector(`[data-e_mfeb2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mfeb2);
                                    const nextCell = document.querySelector(`[data-e_mfeb2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mfeb = d.val().pe_mfeb;
                        if (!pe_mfeb) { pe_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mfeb1="${N0}">${pe_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mfeb: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mfeb1);
                                    const nextCell = document.querySelector(`[data-pe_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mfeb1);
                                    const nextCell = document.querySelector(`[data-pe_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mfeb1);
                                    const nextCell = document.querySelector(`[data-pe_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mfeb = d.val().k_listen_mfeb;
                        var k_speak_mfeb = d.val().k_speak_mfeb;
                        var k_reading_mfeb = d.val().k_reading_mfeb;
                        var k_dictation_mfeb = d.val().k_dictation_mfeb;
                        var k_writing_mfeb = d.val().k_writing_mfeb;
                        var k_grammar_mfeb = d.val().k_grammar_mfeb;
                        var k_homework_mfeb = d.val().k_homework_mfeb;
                        if (!k_listen_mfeb) { k_listen_mfeb = 0 }
                        if (!k_speak_mfeb) { k_speak_mfeb = 0 }
                        if (!k_reading_mfeb) { k_reading_mfeb = 0 }
                        if (!k_writing_mfeb) { k_writing_mfeb = 0 }
                        if (!k_homework_mfeb) { k_homework_mfeb = 0 }
                        if (!k_grammar_mfeb) { k_grammar_mfeb = 0 }
                        if (!k_dictation_mfeb) { k_dictation_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mfeb="${N0}">${k_listen_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mfeb="${N0}">${k_speak_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mfeb="${N0}">${k_reading_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mfeb="${N0}">${k_dictation_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mfeb="${N0}">${k_writing_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mfeb="${N0}">${k_grammar_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mfeb="${N0}">${k_homework_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mfeb: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mfeb);
                                    const nextCell = document.querySelector(`[data-k_grammar_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mfeb);
                                    const nextCell = document.querySelector(`[data-k_grammar_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mfeb);
                                    const nextCell = document.querySelector(`[data-k_grammar_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mfeb);
                                    const nextCell = document.querySelector(`[data-k_listen_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mfeb);
                                    const nextCell = document.querySelector(`[data-k_listen_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mfeb);
                                    const nextCell = document.querySelector(`[data-k_listen_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mfeb);
                                    const nextCell = document.querySelector(`[data-k_speak_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mfeb);
                                    const nextCell = document.querySelector(`[data-k_speak_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mfeb);
                                    const nextCell = document.querySelector(`[data-k_speak_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mfeb);
                                    const nextCell = document.querySelector(`[data-k_reading_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mfeb);
                                    const nextCell = document.querySelector(`[data-k_reading_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mfeb);
                                    const nextCell = document.querySelector(`[data-k_reading_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mfeb);
                                    const nextCell = document.querySelector(`[data-k_dictation_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mfeb);
                                    const nextCell = document.querySelector(`[data-k_dictation_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mfeb);
                                    const nextCell = document.querySelector(`[data-k_dictation_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mfeb);
                                    const nextCell = document.querySelector(`[data-k_writing_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mfeb);
                                    const nextCell = document.querySelector(`[data-k_writing_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mfeb);
                                    const nextCell = document.querySelector(`[data-k_writing_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mfeb);
                                    const nextCell = document.querySelector(`[data-k_homework_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mfeb);
                                    const nextCell = document.querySelector(`[data-k_homework_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mfeb);
                                    const nextCell = document.querySelector(`[data-k_homework_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mfeb = d.val().math_mfeb;
                        var math_h_mfeb = d.val().math_h_mfeb;
                        var math_speak_mfeb = d.val().math_speak_mfeb;
                        if (!math_mfeb) { math_mfeb = 0 }
                        if (!math_h_mfeb) { math_h_mfeb = 0 }
                        if (!math_speak_mfeb) { math_speak_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mfeb1="${N0}">${math_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mfeb="${N0}">${math_h_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mfeb="${N0}">${math_speak_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mfeb: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mfeb1);
                                    const nextCell = document.querySelector(`[data-math_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mfeb1);
                                    const nextCell = document.querySelector(`[data-math_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mfeb1);
                                    const nextCell = document.querySelector(`[data-math_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mfeb);
                                    const nextCell = document.querySelector(`[data-math_h_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mfeb);
                                    const nextCell = document.querySelector(`[data-math_h_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mfeb);
                                    const nextCell = document.querySelector(`[data-math_h_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mfeb);
                                    const nextCell = document.querySelector(`[data-math_speak_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mfeb);
                                    const nextCell = document.querySelector(`[data-math_speak_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mfeb);
                                    const nextCell = document.querySelector(`[data-math_speak_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mfeb = d.val().sci_mfeb;
                        var sci_h_mfeb = d.val().sci_h_mfeb;
                        if (!sci_mfeb) { sci_mfeb = 0 }
                        if (!sci_h_mfeb) { sci_h_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mfeb1="${N0}">${sci_mfeb}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mfeb="${N0}">${sci_h_mfeb}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mfeb: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mfeb1);
                                    const nextCell = document.querySelector(`[data-sci_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mfeb1);
                                    const nextCell = document.querySelector(`[data-sci_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mfeb1);
                                    const nextCell = document.querySelector(`[data-sci_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mfeb);
                                    const nextCell = document.querySelector(`[data-sci_h_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mfeb);
                                    const nextCell = document.querySelector(`[data-sci_h_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mfeb);
                                    const nextCell = document.querySelector(`[data-sci_h_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mfeb = d.val().soc_mfeb;
                        var soc_h_mfeb = d.val().soc_h_mfeb;
                        if (!soc_mfeb) { soc_mfeb = 0 }
                        if (!soc_h_mfeb) { soc_h_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mfeb1="${N0}">${soc_mfeb}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mfeb="${N0}">${soc_h_mfeb}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mfeb: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mfeb: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mfeb1);
                                    const nextCell = document.querySelector(`[data-soc_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mfeb1);
                                    const nextCell = document.querySelector(`[data-soc_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mfeb1);
                                    const nextCell = document.querySelector(`[data-soc_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mfeb);
                                    const nextCell = document.querySelector(`[data-soc_h_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mfeb);
                                    const nextCell = document.querySelector(`[data-soc_h_mfeb="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mfeb);
                                    const nextCell = document.querySelector(`[data-soc_h_mfeb="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mfeb = d.val().geor_mfeb;
                        if (!geor_mfeb) { geor_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mfeb1="${N0}">${geor_mfeb}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mfeb: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mfeb1);
                                    const nextCell = document.querySelector(`[data-geor_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mfeb1);
                                    const nextCell = document.querySelector(`[data-geor_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mfeb1);
                                    const nextCell = document.querySelector(`[data-geor_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mfeb = d.val().hist_mfeb;
                        if (!hist_mfeb) { hist_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mfeb1="${N0}">${hist_mfeb}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mfeb: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mfeb1);
                                    const nextCell = document.querySelector(`[data-hist_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mfeb1);
                                    const nextCell = document.querySelector(`[data-hist_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mfeb1);
                                    const nextCell = document.querySelector(`[data-hist_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mfeb = d.val().moral_mfeb;
                        if (!moral_mfeb) { moral_mfeb = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mfeb1="${N0}">${moral_mfeb}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mfeb: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mfeb1);
                                    const nextCell = document.querySelector(`[data-moral_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mfeb1);
                                    const nextCell = document.querySelector(`[data-moral_mfeb1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mfeb1);
                                    const nextCell = document.querySelector(`[data-moral_mfeb1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែមីនា
    if (user_month == 'March') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mmarch = d.val().e_mmarch;
                        var e_h_mmarch = d.val().e_h_mmarch;
                        if (!e_mmarch) { e_mmarch = 0 }
                        if (!e_h_mmarch) { e_h_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mmarch1="${N0}">${e_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mmarch2="${N0}">${e_h_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch1);
                                    const nextCell = document.querySelector(`[data-e_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch1);
                                    const nextCell = document.querySelector(`[data-e_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch1);
                                    const nextCell = document.querySelector(`[data-e_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch2);
                                    const nextCell = document.querySelector(`[data-e_mmarch2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch2);
                                    const nextCell = document.querySelector(`[data-e_mmarch2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mmarch2);
                                    const nextCell = document.querySelector(`[data-e_mmarch2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mmarch = d.val().pe_mmarch;
                        if (!pe_mmarch) { pe_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mmarch1="${N0}">${pe_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mmarch: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mmarch1);
                                    const nextCell = document.querySelector(`[data-pe_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mmarch1);
                                    const nextCell = document.querySelector(`[data-pe_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mmarch1);
                                    const nextCell = document.querySelector(`[data-pe_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mmarch = d.val().k_listen_mmarch;
                        var k_speak_mmarch = d.val().k_speak_mmarch;
                        var k_reading_mmarch = d.val().k_reading_mmarch;
                        var k_dictation_mmarch = d.val().k_dictation_mmarch;
                        var k_writing_mmarch = d.val().k_writing_mmarch;
                        var k_grammar_mmarch = d.val().k_grammar_mmarch;
                        var k_homework_mmarch = d.val().k_homework_mmarch;
                        if (!k_listen_mmarch) { k_listen_mmarch = 0 }
                        if (!k_speak_mmarch) { k_speak_mmarch = 0 }
                        if (!k_reading_mmarch) { k_reading_mmarch = 0 }
                        if (!k_writing_mmarch) { k_writing_mmarch = 0 }
                        if (!k_homework_mmarch) { k_homework_mmarch = 0 }
                        if (!k_grammar_mmarch) { k_grammar_mmarch = 0 }
                        if (!k_dictation_mmarch) { k_dictation_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mmarch="${N0}">${k_listen_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mmarch="${N0}">${k_speak_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mmarch="${N0}">${k_reading_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mmarch="${N0}">${k_dictation_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mmarch="${N0}">${k_writing_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mmarch="${N0}">${k_grammar_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mmarch="${N0}">${k_homework_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mmarch: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mmarch);
                                    const nextCell = document.querySelector(`[data-k_grammar_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mmarch);
                                    const nextCell = document.querySelector(`[data-k_grammar_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mmarch);
                                    const nextCell = document.querySelector(`[data-k_grammar_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mmarch);
                                    const nextCell = document.querySelector(`[data-k_listen_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mmarch);
                                    const nextCell = document.querySelector(`[data-k_listen_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mmarch);
                                    const nextCell = document.querySelector(`[data-k_listen_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mmarch);
                                    const nextCell = document.querySelector(`[data-k_speak_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mmarch);
                                    const nextCell = document.querySelector(`[data-k_speak_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mmarch);
                                    const nextCell = document.querySelector(`[data-k_speak_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mmarch);
                                    const nextCell = document.querySelector(`[data-k_reading_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mmarch);
                                    const nextCell = document.querySelector(`[data-k_reading_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mmarch);
                                    const nextCell = document.querySelector(`[data-k_reading_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mmarch);
                                    const nextCell = document.querySelector(`[data-k_dictation_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mmarch);
                                    const nextCell = document.querySelector(`[data-k_dictation_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mmarch);
                                    const nextCell = document.querySelector(`[data-k_dictation_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mmarch);
                                    const nextCell = document.querySelector(`[data-k_writing_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mmarch);
                                    const nextCell = document.querySelector(`[data-k_writing_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mmarch);
                                    const nextCell = document.querySelector(`[data-k_writing_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mmarch);
                                    const nextCell = document.querySelector(`[data-k_homework_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mmarch);
                                    const nextCell = document.querySelector(`[data-k_homework_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mmarch);
                                    const nextCell = document.querySelector(`[data-k_homework_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mmarch = d.val().math_mmarch;
                        var math_h_mmarch = d.val().math_h_mmarch;
                        var math_speak_mmarch = d.val().math_speak_mmarch;
                        if (!math_mmarch) { math_mmarch = 0 }
                        if (!math_h_mmarch) { math_h_mmarch = 0 }
                        if (!math_speak_mmarch) { math_speak_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mmarch1="${N0}">${math_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mmarch="${N0}">${math_h_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mmarch="${N0}">${math_speak_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mmarch: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mmarch1);
                                    const nextCell = document.querySelector(`[data-math_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mmarch1);
                                    const nextCell = document.querySelector(`[data-math_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mmarch1);
                                    const nextCell = document.querySelector(`[data-math_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mmarch);
                                    const nextCell = document.querySelector(`[data-math_h_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mmarch);
                                    const nextCell = document.querySelector(`[data-math_h_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mmarch);
                                    const nextCell = document.querySelector(`[data-math_h_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mmarch);
                                    const nextCell = document.querySelector(`[data-math_speak_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mmarch);
                                    const nextCell = document.querySelector(`[data-math_speak_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mmarch);
                                    const nextCell = document.querySelector(`[data-math_speak_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mmarch = d.val().sci_mmarch;
                        var sci_h_mmarch = d.val().sci_h_mmarch;
                        if (!sci_mmarch) { sci_mmarch = 0 }
                        if (!sci_h_mmarch) { sci_h_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mmarch1="${N0}">${sci_mmarch}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mmarch="${N0}">${sci_h_mmarch}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mmarch: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mmarch1);
                                    const nextCell = document.querySelector(`[data-sci_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mmarch1);
                                    const nextCell = document.querySelector(`[data-sci_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mmarch1);
                                    const nextCell = document.querySelector(`[data-sci_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mmarch);
                                    const nextCell = document.querySelector(`[data-sci_h_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mmarch);
                                    const nextCell = document.querySelector(`[data-sci_h_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mmarch);
                                    const nextCell = document.querySelector(`[data-sci_h_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mmarch = d.val().soc_mmarch;
                        var soc_h_mmarch = d.val().soc_h_mmarch;
                        if (!soc_mmarch) { soc_mmarch = 0 }
                        if (!soc_h_mmarch) { soc_h_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mmarch1="${N0}">${soc_mmarch}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mmarch="${N0}">${soc_h_mmarch}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mmarch: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mmarch: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mmarch1);
                                    const nextCell = document.querySelector(`[data-soc_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mmarch1);
                                    const nextCell = document.querySelector(`[data-soc_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mmarch1);
                                    const nextCell = document.querySelector(`[data-soc_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mmarch);
                                    const nextCell = document.querySelector(`[data-soc_h_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mmarch);
                                    const nextCell = document.querySelector(`[data-soc_h_mmarch="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mmarch);
                                    const nextCell = document.querySelector(`[data-soc_h_mmarch="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mmarch = d.val().geor_mmarch;
                        if (!geor_mmarch) { geor_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mmarch1="${N0}">${geor_mmarch}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mmarch: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mmarch1);
                                    const nextCell = document.querySelector(`[data-geor_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mmarch1);
                                    const nextCell = document.querySelector(`[data-geor_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mmarch1);
                                    const nextCell = document.querySelector(`[data-geor_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mmarch = d.val().hist_mmarch;
                        if (!hist_mmarch) { hist_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mmarch1="${N0}">${hist_mmarch}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mmarch: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mmarch1);
                                    const nextCell = document.querySelector(`[data-hist_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mmarch1);
                                    const nextCell = document.querySelector(`[data-hist_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mmarch1);
                                    const nextCell = document.querySelector(`[data-hist_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mmarch = d.val().moral_mmarch;
                        if (!moral_mmarch) { moral_mmarch = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mmarch1="${N0}">${moral_mmarch}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mmarch: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mmarch1);
                                    const nextCell = document.querySelector(`[data-moral_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mmarch1);
                                    const nextCell = document.querySelector(`[data-moral_mmarch1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mmarch1);
                                    const nextCell = document.querySelector(`[data-moral_mmarch1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែមេសា-ឧសភា
    if (user_month == 'April-May') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mapma = d.val().e_mapma;
                        var e_h_mapma = d.val().e_h_mapma;
                        if (!e_mapma) { e_mapma = 0 }
                        if (!e_h_mapma) { e_h_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mapma1="${N0}">${e_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mapma2="${N0}">${e_h_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma1);
                                    const nextCell = document.querySelector(`[data-e_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma1);
                                    const nextCell = document.querySelector(`[data-e_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma1);
                                    const nextCell = document.querySelector(`[data-e_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma2);
                                    const nextCell = document.querySelector(`[data-e_mapma2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma2);
                                    const nextCell = document.querySelector(`[data-e_mapma2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mapma2);
                                    const nextCell = document.querySelector(`[data-e_mapma2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mapma = d.val().pe_mapma;
                        if (!pe_mapma) { pe_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mapma1="${N0}">${pe_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mapma: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mapma1);
                                    const nextCell = document.querySelector(`[data-pe_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mapma1);
                                    const nextCell = document.querySelector(`[data-pe_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mapma1);
                                    const nextCell = document.querySelector(`[data-pe_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mapma = d.val().k_listen_mapma;
                        var k_speak_mapma = d.val().k_speak_mapma;
                        var k_reading_mapma = d.val().k_reading_mapma;
                        var k_dictation_mapma = d.val().k_dictation_mapma;
                        var k_writing_mapma = d.val().k_writing_mapma;
                        var k_grammar_mapma = d.val().k_grammar_mapma;
                        var k_homework_mapma = d.val().k_homework_mapma;
                        if (!k_listen_mapma) { k_listen_mapma = 0 }
                        if (!k_speak_mapma) { k_speak_mapma = 0 }
                        if (!k_reading_mapma) { k_reading_mapma = 0 }
                        if (!k_writing_mapma) { k_writing_mapma = 0 }
                        if (!k_homework_mapma) { k_homework_mapma = 0 }
                        if (!k_grammar_mapma) { k_grammar_mapma = 0 }
                        if (!k_dictation_mapma) { k_dictation_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mapma="${N0}">${k_listen_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mapma="${N0}">${k_speak_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mapma="${N0}">${k_reading_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mapma="${N0}">${k_dictation_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mapma="${N0}">${k_writing_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mapma="${N0}">${k_grammar_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mapma="${N0}">${k_homework_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mapma: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mapma);
                                    const nextCell = document.querySelector(`[data-k_grammar_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mapma);
                                    const nextCell = document.querySelector(`[data-k_grammar_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mapma);
                                    const nextCell = document.querySelector(`[data-k_grammar_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mapma);
                                    const nextCell = document.querySelector(`[data-k_listen_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mapma);
                                    const nextCell = document.querySelector(`[data-k_listen_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mapma);
                                    const nextCell = document.querySelector(`[data-k_listen_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mapma);
                                    const nextCell = document.querySelector(`[data-k_speak_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mapma);
                                    const nextCell = document.querySelector(`[data-k_speak_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mapma);
                                    const nextCell = document.querySelector(`[data-k_speak_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mapma);
                                    const nextCell = document.querySelector(`[data-k_reading_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mapma);
                                    const nextCell = document.querySelector(`[data-k_reading_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mapma);
                                    const nextCell = document.querySelector(`[data-k_reading_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mapma);
                                    const nextCell = document.querySelector(`[data-k_dictation_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mapma);
                                    const nextCell = document.querySelector(`[data-k_dictation_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mapma);
                                    const nextCell = document.querySelector(`[data-k_dictation_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mapma);
                                    const nextCell = document.querySelector(`[data-k_writing_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mapma);
                                    const nextCell = document.querySelector(`[data-k_writing_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mapma);
                                    const nextCell = document.querySelector(`[data-k_writing_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mapma);
                                    const nextCell = document.querySelector(`[data-k_homework_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mapma);
                                    const nextCell = document.querySelector(`[data-k_homework_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mapma);
                                    const nextCell = document.querySelector(`[data-k_homework_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mapma = d.val().math_mapma;
                        var math_h_mapma = d.val().math_h_mapma;
                        var math_speak_mapma = d.val().math_speak_mapma;
                        if (!math_mapma) { math_mapma = 0 }
                        if (!math_h_mapma) { math_h_mapma = 0 }
                        if (!math_speak_mapma) { math_speak_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mapma1="${N0}">${math_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mapma="${N0}">${math_h_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mapma="${N0}">${math_speak_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mapma: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mapma1);
                                    const nextCell = document.querySelector(`[data-math_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mapma1);
                                    const nextCell = document.querySelector(`[data-math_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mapma1);
                                    const nextCell = document.querySelector(`[data-math_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mapma);
                                    const nextCell = document.querySelector(`[data-math_h_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mapma);
                                    const nextCell = document.querySelector(`[data-math_h_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mapma);
                                    const nextCell = document.querySelector(`[data-math_h_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mapma);
                                    const nextCell = document.querySelector(`[data-math_speak_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mapma);
                                    const nextCell = document.querySelector(`[data-math_speak_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mapma);
                                    const nextCell = document.querySelector(`[data-math_speak_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mapma = d.val().sci_mapma;
                        var sci_h_mapma = d.val().sci_h_mapma;
                        if (!sci_mapma) { sci_mapma = 0 }
                        if (!sci_h_mapma) { sci_h_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mapma1="${N0}">${sci_mapma}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mapma="${N0}">${sci_h_mapma}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mapma: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mapma1);
                                    const nextCell = document.querySelector(`[data-sci_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mapma1);
                                    const nextCell = document.querySelector(`[data-sci_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mapma1);
                                    const nextCell = document.querySelector(`[data-sci_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mapma);
                                    const nextCell = document.querySelector(`[data-sci_h_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mapma);
                                    const nextCell = document.querySelector(`[data-sci_h_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mapma);
                                    const nextCell = document.querySelector(`[data-sci_h_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mapma = d.val().soc_mapma;
                        var soc_h_mapma = d.val().soc_h_mapma;
                        if (!soc_mapma) { soc_mapma = 0 }
                        if (!soc_h_mapma) { soc_h_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mapma1="${N0}">${soc_mapma}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mapma="${N0}">${soc_h_mapma}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mapma: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mapma: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mapma1);
                                    const nextCell = document.querySelector(`[data-soc_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mapma1);
                                    const nextCell = document.querySelector(`[data-soc_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mapma1);
                                    const nextCell = document.querySelector(`[data-soc_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mapma);
                                    const nextCell = document.querySelector(`[data-soc_h_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mapma);
                                    const nextCell = document.querySelector(`[data-soc_h_mapma="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mapma);
                                    const nextCell = document.querySelector(`[data-soc_h_mapma="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mapma = d.val().geor_mapma;
                        if (!geor_mapma) { geor_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mapma1="${N0}">${geor_mapma}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mapma: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mapma1);
                                    const nextCell = document.querySelector(`[data-geor_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mapma1);
                                    const nextCell = document.querySelector(`[data-geor_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mapma1);
                                    const nextCell = document.querySelector(`[data-geor_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mapma = d.val().hist_mapma;
                        if (!hist_mapma) { hist_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mapma1="${N0}">${hist_mapma}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mapma: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mapma1);
                                    const nextCell = document.querySelector(`[data-hist_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mapma1);
                                    const nextCell = document.querySelector(`[data-hist_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mapma1);
                                    const nextCell = document.querySelector(`[data-hist_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mapma = d.val().moral_mapma;
                        if (!moral_mapma) { moral_mapma = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mapma1="${N0}">${moral_mapma}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mapma: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mapma1);
                                    const nextCell = document.querySelector(`[data-moral_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mapma1);
                                    const nextCell = document.querySelector(`[data-moral_mapma1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mapma1);
                                    const nextCell = document.querySelector(`[data-moral_mapma1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែមិថុនា
    if (user_month == 'June') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mjun = d.val().e_mjun;
                        var e_h_mjun = d.val().e_h_mjun;
                        if (!e_mjun) { e_mjun = 0 }
                        if (!e_h_mjun) { e_h_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mjun1="${N0}">${e_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mjun2="${N0}">${e_h_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun1);
                                    const nextCell = document.querySelector(`[data-e_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun1);
                                    const nextCell = document.querySelector(`[data-e_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun1);
                                    const nextCell = document.querySelector(`[data-e_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun2);
                                    const nextCell = document.querySelector(`[data-e_mjun2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun2);
                                    const nextCell = document.querySelector(`[data-e_mjun2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjun2);
                                    const nextCell = document.querySelector(`[data-e_mjun2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mjun = d.val().pe_mjun;
                        if (!pe_mjun) { pe_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mjun1="${N0}">${pe_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mjun: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjun1);
                                    const nextCell = document.querySelector(`[data-pe_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjun1);
                                    const nextCell = document.querySelector(`[data-pe_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjun1);
                                    const nextCell = document.querySelector(`[data-pe_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mjun = d.val().k_listen_mjun;
                        var k_speak_mjun = d.val().k_speak_mjun;
                        var k_reading_mjun = d.val().k_reading_mjun;
                        var k_dictation_mjun = d.val().k_dictation_mjun;
                        var k_writing_mjun = d.val().k_writing_mjun;
                        var k_grammar_mjun = d.val().k_grammar_mjun;
                        var k_homework_mjun = d.val().k_homework_mjun;
                        if (!k_listen_mjun) { k_listen_mjun = 0 }
                        if (!k_speak_mjun) { k_speak_mjun = 0 }
                        if (!k_reading_mjun) { k_reading_mjun = 0 }
                        if (!k_writing_mjun) { k_writing_mjun = 0 }
                        if (!k_homework_mjun) { k_homework_mjun = 0 }
                        if (!k_grammar_mjun) { k_grammar_mjun = 0 }
                        if (!k_dictation_mjun) { k_dictation_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mjun="${N0}">${k_listen_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mjun="${N0}">${k_speak_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mjun="${N0}">${k_reading_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mjun="${N0}">${k_dictation_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mjun="${N0}">${k_writing_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mjun="${N0}">${k_grammar_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mjun="${N0}">${k_homework_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mjun: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjun);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjun);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjun);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjun);
                                    const nextCell = document.querySelector(`[data-k_listen_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjun);
                                    const nextCell = document.querySelector(`[data-k_listen_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjun);
                                    const nextCell = document.querySelector(`[data-k_listen_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjun);
                                    const nextCell = document.querySelector(`[data-k_speak_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjun);
                                    const nextCell = document.querySelector(`[data-k_speak_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjun);
                                    const nextCell = document.querySelector(`[data-k_speak_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjun);
                                    const nextCell = document.querySelector(`[data-k_reading_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjun);
                                    const nextCell = document.querySelector(`[data-k_reading_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjun);
                                    const nextCell = document.querySelector(`[data-k_reading_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjun);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjun);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjun);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjun);
                                    const nextCell = document.querySelector(`[data-k_writing_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjun);
                                    const nextCell = document.querySelector(`[data-k_writing_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjun);
                                    const nextCell = document.querySelector(`[data-k_writing_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjun);
                                    const nextCell = document.querySelector(`[data-k_homework_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjun);
                                    const nextCell = document.querySelector(`[data-k_homework_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjun);
                                    const nextCell = document.querySelector(`[data-k_homework_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mjun = d.val().math_mjun;
                        var math_h_mjun = d.val().math_h_mjun;
                        var math_speak_mjun = d.val().math_speak_mjun;
                        if (!math_mjun) { math_mjun = 0 }
                        if (!math_h_mjun) { math_h_mjun = 0 }
                        if (!math_speak_mjun) { math_speak_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mjun1="${N0}">${math_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mjun="${N0}">${math_h_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mjun="${N0}">${math_speak_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mjun: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjun1);
                                    const nextCell = document.querySelector(`[data-math_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjun1);
                                    const nextCell = document.querySelector(`[data-math_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjun1);
                                    const nextCell = document.querySelector(`[data-math_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjun);
                                    const nextCell = document.querySelector(`[data-math_h_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjun);
                                    const nextCell = document.querySelector(`[data-math_h_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjun);
                                    const nextCell = document.querySelector(`[data-math_h_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjun);
                                    const nextCell = document.querySelector(`[data-math_speak_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjun);
                                    const nextCell = document.querySelector(`[data-math_speak_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjun);
                                    const nextCell = document.querySelector(`[data-math_speak_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mjun = d.val().sci_mjun;
                        var sci_h_mjun = d.val().sci_h_mjun;
                        if (!sci_mjun) { sci_mjun = 0 }
                        if (!sci_h_mjun) { sci_h_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mjun1="${N0}">${sci_mjun}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mjun="${N0}">${sci_h_mjun}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mjun: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjun1);
                                    const nextCell = document.querySelector(`[data-sci_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjun1);
                                    const nextCell = document.querySelector(`[data-sci_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjun1);
                                    const nextCell = document.querySelector(`[data-sci_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjun);
                                    const nextCell = document.querySelector(`[data-sci_h_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjun);
                                    const nextCell = document.querySelector(`[data-sci_h_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjun);
                                    const nextCell = document.querySelector(`[data-sci_h_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mjun = d.val().soc_mjun;
                        var soc_h_mjun = d.val().soc_h_mjun;
                        if (!soc_mjun) { soc_mjun = 0 }
                        if (!soc_h_mjun) { soc_h_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mjun1="${N0}">${soc_mjun}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mjun="${N0}">${soc_h_mjun}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mjun: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mjun: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjun1);
                                    const nextCell = document.querySelector(`[data-soc_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjun1);
                                    const nextCell = document.querySelector(`[data-soc_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjun1);
                                    const nextCell = document.querySelector(`[data-soc_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjun);
                                    const nextCell = document.querySelector(`[data-soc_h_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjun);
                                    const nextCell = document.querySelector(`[data-soc_h_mjun="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjun);
                                    const nextCell = document.querySelector(`[data-soc_h_mjun="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mjun = d.val().geor_mjun;
                        if (!geor_mjun) { geor_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mjun1="${N0}">${geor_mjun}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mjun: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjun1);
                                    const nextCell = document.querySelector(`[data-geor_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjun1);
                                    const nextCell = document.querySelector(`[data-geor_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjun1);
                                    const nextCell = document.querySelector(`[data-geor_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mjun = d.val().hist_mjun;
                        if (!hist_mjun) { hist_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mjun1="${N0}">${hist_mjun}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mjun: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjun1);
                                    const nextCell = document.querySelector(`[data-hist_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjun1);
                                    const nextCell = document.querySelector(`[data-hist_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjun1);
                                    const nextCell = document.querySelector(`[data-hist_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mjun = d.val().moral_mjun;
                        if (!moral_mjun) { moral_mjun = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mjun1="${N0}">${moral_mjun}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mjun: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjun1);
                                    const nextCell = document.querySelector(`[data-moral_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjun1);
                                    const nextCell = document.querySelector(`[data-moral_mjun1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjun1);
                                    const nextCell = document.querySelector(`[data-moral_mjun1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }

    // ខែកក្កដា
    if (user_month == 'July') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_mjul = d.val().e_mjul;
                        var e_h_mjul = d.val().e_h_mjul;
                        if (!e_mjul) { e_mjul = 0 }
                        if (!e_h_mjul) { e_h_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_mjul1="${N0}">${e_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_mjul2="${N0}">${e_h_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul1);
                                    const nextCell = document.querySelector(`[data-e_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul1);
                                    const nextCell = document.querySelector(`[data-e_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul1);
                                    const nextCell = document.querySelector(`[data-e_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul2);
                                    const nextCell = document.querySelector(`[data-e_mjul2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul2);
                                    const nextCell = document.querySelector(`[data-e_mjul2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_mjul2);
                                    const nextCell = document.querySelector(`[data-e_mjul2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_mjul = d.val().pe_mjul;
                        if (!pe_mjul) { pe_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_mjul1="${N0}">${pe_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_mjul: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjul1);
                                    const nextCell = document.querySelector(`[data-pe_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjul1);
                                    const nextCell = document.querySelector(`[data-pe_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_mjul1);
                                    const nextCell = document.querySelector(`[data-pe_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_mjul = d.val().k_listen_mjul;
                        var k_speak_mjul = d.val().k_speak_mjul;
                        var k_reading_mjul = d.val().k_reading_mjul;
                        var k_dictation_mjul = d.val().k_dictation_mjul;
                        var k_writing_mjul = d.val().k_writing_mjul;
                        var k_grammar_mjul = d.val().k_grammar_mjul;
                        var k_homework_mjul = d.val().k_homework_mjul;
                        if (!k_listen_mjul) { k_listen_mjul = 0 }
                        if (!k_speak_mjul) { k_speak_mjul = 0 }
                        if (!k_reading_mjul) { k_reading_mjul = 0 }
                        if (!k_writing_mjul) { k_writing_mjul = 0 }
                        if (!k_homework_mjul) { k_homework_mjul = 0 }
                        if (!k_grammar_mjul) { k_grammar_mjul = 0 }
                        if (!k_dictation_mjul) { k_dictation_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_mjul="${N0}">${k_listen_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_mjul="${N0}">${k_speak_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_mjul="${N0}">${k_reading_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_mjul="${N0}">${k_dictation_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_mjul="${N0}">${k_writing_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_mjul="${N0}">${k_grammar_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_mjul="${N0}">${k_homework_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_mjul: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjul);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjul);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_mjul);
                                    const nextCell = document.querySelector(`[data-k_grammar_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjul);
                                    const nextCell = document.querySelector(`[data-k_listen_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjul);
                                    const nextCell = document.querySelector(`[data-k_listen_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_mjul);
                                    const nextCell = document.querySelector(`[data-k_listen_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjul);
                                    const nextCell = document.querySelector(`[data-k_speak_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjul);
                                    const nextCell = document.querySelector(`[data-k_speak_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_mjul);
                                    const nextCell = document.querySelector(`[data-k_speak_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjul);
                                    const nextCell = document.querySelector(`[data-k_reading_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjul);
                                    const nextCell = document.querySelector(`[data-k_reading_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_mjul);
                                    const nextCell = document.querySelector(`[data-k_reading_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjul);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjul);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_mjul);
                                    const nextCell = document.querySelector(`[data-k_dictation_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjul);
                                    const nextCell = document.querySelector(`[data-k_writing_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjul);
                                    const nextCell = document.querySelector(`[data-k_writing_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_mjul);
                                    const nextCell = document.querySelector(`[data-k_writing_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjul);
                                    const nextCell = document.querySelector(`[data-k_homework_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjul);
                                    const nextCell = document.querySelector(`[data-k_homework_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_mjul);
                                    const nextCell = document.querySelector(`[data-k_homework_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_mjul = d.val().math_mjul;
                        var math_h_mjul = d.val().math_h_mjul;
                        var math_speak_mjul = d.val().math_speak_mjul;
                        if (!math_mjul) { math_mjul = 0 }
                        if (!math_h_mjul) { math_h_mjul = 0 }
                        if (!math_speak_mjul) { math_speak_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_mjul1="${N0}">${math_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_mjul="${N0}">${math_h_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_mjul="${N0}">${math_speak_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_mjul: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjul1);
                                    const nextCell = document.querySelector(`[data-math_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjul1);
                                    const nextCell = document.querySelector(`[data-math_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_mjul1);
                                    const nextCell = document.querySelector(`[data-math_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjul);
                                    const nextCell = document.querySelector(`[data-math_h_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjul);
                                    const nextCell = document.querySelector(`[data-math_h_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_mjul);
                                    const nextCell = document.querySelector(`[data-math_h_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjul);
                                    const nextCell = document.querySelector(`[data-math_speak_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjul);
                                    const nextCell = document.querySelector(`[data-math_speak_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_mjul);
                                    const nextCell = document.querySelector(`[data-math_speak_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_mjul = d.val().sci_mjul;
                        var sci_h_mjul = d.val().sci_h_mjul;
                        if (!sci_mjul) { sci_mjul = 0 }
                        if (!sci_h_mjul) { sci_h_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_mjul1="${N0}">${sci_mjul}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_mjul="${N0}">${sci_h_mjul}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_mjul: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjul1);
                                    const nextCell = document.querySelector(`[data-sci_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjul1);
                                    const nextCell = document.querySelector(`[data-sci_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_mjul1);
                                    const nextCell = document.querySelector(`[data-sci_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjul);
                                    const nextCell = document.querySelector(`[data-sci_h_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjul);
                                    const nextCell = document.querySelector(`[data-sci_h_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_mjul);
                                    const nextCell = document.querySelector(`[data-sci_h_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_mjul = d.val().soc_mjul;
                        var soc_h_mjul = d.val().soc_h_mjul;
                        if (!soc_mjul) { soc_mjul = 0 }
                        if (!soc_h_mjul) { soc_h_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_mjul1="${N0}">${soc_mjul}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_mjul="${N0}">${soc_h_mjul}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_mjul: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_mjul: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjul1);
                                    const nextCell = document.querySelector(`[data-soc_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjul1);
                                    const nextCell = document.querySelector(`[data-soc_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_mjul1);
                                    const nextCell = document.querySelector(`[data-soc_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjul);
                                    const nextCell = document.querySelector(`[data-soc_h_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjul);
                                    const nextCell = document.querySelector(`[data-soc_h_mjul="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_mjul);
                                    const nextCell = document.querySelector(`[data-soc_h_mjul="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_mjul = d.val().geor_mjul;
                        if (!geor_mjul) { geor_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_mjul1="${N0}">${geor_mjul}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_mjul: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjul1);
                                    const nextCell = document.querySelector(`[data-geor_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjul1);
                                    const nextCell = document.querySelector(`[data-geor_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_mjul1);
                                    const nextCell = document.querySelector(`[data-geor_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_mjul = d.val().hist_mjul;
                        if (!hist_mjul) { hist_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_mjul1="${N0}">${hist_mjul}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_mjul: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjul1);
                                    const nextCell = document.querySelector(`[data-hist_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjul1);
                                    const nextCell = document.querySelector(`[data-hist_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_mjul1);
                                    const nextCell = document.querySelector(`[data-hist_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_mjul = d.val().moral_mjul;
                        if (!moral_mjul) { moral_mjul = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_mjul1="${N0}">${moral_mjul}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_mjul: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjul1);
                                    const nextCell = document.querySelector(`[data-moral_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjul1);
                                    const nextCell = document.querySelector(`[data-moral_mjul1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_mjul1);
                                    const nextCell = document.querySelector(`[data-moral_mjul1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }
    // ឆមាសទី១
    if (user_month == '1st Semester') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_m1semester = d.val().e_m1semester;
                        var e_h_m1semester = d.val().e_h_m1semester;
                        if (!e_m1semester) { e_m1semester = 0 }
                        if (!e_h_m1semester) { e_h_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_m1semester1="${N0}">${e_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_m1semester2="${N0}">${e_h_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester1);
                                    const nextCell = document.querySelector(`[data-e_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester1);
                                    const nextCell = document.querySelector(`[data-e_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester1);
                                    const nextCell = document.querySelector(`[data-e_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester2);
                                    const nextCell = document.querySelector(`[data-e_m1semester2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester2);
                                    const nextCell = document.querySelector(`[data-e_m1semester2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m1semester2);
                                    const nextCell = document.querySelector(`[data-e_m1semester2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_m1semester = d.val().pe_m1semester;
                        if (!pe_m1semester) { pe_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_m1semester1="${N0}">${pe_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_m1semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m1semester1);
                                    const nextCell = document.querySelector(`[data-pe_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m1semester1);
                                    const nextCell = document.querySelector(`[data-pe_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m1semester1);
                                    const nextCell = document.querySelector(`[data-pe_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_m1semester = d.val().k_listen_m1semester;
                        var k_speak_m1semester = d.val().k_speak_m1semester;
                        var k_reading_m1semester = d.val().k_reading_m1semester;
                        var k_dictation_m1semester = d.val().k_dictation_m1semester;
                        var k_writing_m1semester = d.val().k_writing_m1semester;
                        var k_grammar_m1semester = d.val().k_grammar_m1semester;
                        var k_homework_m1semester = d.val().k_homework_m1semester;
                        if (!k_listen_m1semester) { k_listen_m1semester = 0 }
                        if (!k_speak_m1semester) { k_speak_m1semester = 0 }
                        if (!k_reading_m1semester) { k_reading_m1semester = 0 }
                        if (!k_writing_m1semester) { k_writing_m1semester = 0 }
                        if (!k_homework_m1semester) { k_homework_m1semester = 0 }
                        if (!k_grammar_m1semester) { k_grammar_m1semester = 0 }
                        if (!k_dictation_m1semester) { k_dictation_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_m1semester="${N0}">${k_listen_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_m1semester="${N0}">${k_speak_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_m1semester="${N0}">${k_reading_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_m1semester="${N0}">${k_dictation_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_m1semester="${N0}">${k_writing_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_m1semester="${N0}">${k_grammar_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_m1semester="${N0}">${k_homework_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_m1semester: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_m1semester);
                                    const nextCell = document.querySelector(`[data-k_grammar_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_m1semester);
                                    const nextCell = document.querySelector(`[data-k_grammar_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_m1semester);
                                    const nextCell = document.querySelector(`[data-k_grammar_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_m1semester);
                                    const nextCell = document.querySelector(`[data-k_listen_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_m1semester);
                                    const nextCell = document.querySelector(`[data-k_listen_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_m1semester);
                                    const nextCell = document.querySelector(`[data-k_listen_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_m1semester);
                                    const nextCell = document.querySelector(`[data-k_speak_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_m1semester);
                                    const nextCell = document.querySelector(`[data-k_speak_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_m1semester);
                                    const nextCell = document.querySelector(`[data-k_speak_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_m1semester);
                                    const nextCell = document.querySelector(`[data-k_reading_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_m1semester);
                                    const nextCell = document.querySelector(`[data-k_reading_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_m1semester);
                                    const nextCell = document.querySelector(`[data-k_reading_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_m1semester);
                                    const nextCell = document.querySelector(`[data-k_dictation_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_m1semester);
                                    const nextCell = document.querySelector(`[data-k_dictation_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_m1semester);
                                    const nextCell = document.querySelector(`[data-k_dictation_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_m1semester);
                                    const nextCell = document.querySelector(`[data-k_writing_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_m1semester);
                                    const nextCell = document.querySelector(`[data-k_writing_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_m1semester);
                                    const nextCell = document.querySelector(`[data-k_writing_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_m1semester);
                                    const nextCell = document.querySelector(`[data-k_homework_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_m1semester);
                                    const nextCell = document.querySelector(`[data-k_homework_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_m1semester);
                                    const nextCell = document.querySelector(`[data-k_homework_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_m1semester = d.val().math_m1semester;
                        var math_h_m1semester = d.val().math_h_m1semester;
                        var math_speak_m1semester = d.val().math_speak_m1semester;
                        if (!math_m1semester) { math_m1semester = 0 }
                        if (!math_h_m1semester) { math_h_m1semester = 0 }
                        if (!math_speak_m1semester) { math_speak_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_m1semester1="${N0}">${math_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_m1semester="${N0}">${math_h_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_m1semester="${N0}">${math_speak_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_m1semester: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m1semester1);
                                    const nextCell = document.querySelector(`[data-math_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m1semester1);
                                    const nextCell = document.querySelector(`[data-math_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m1semester1);
                                    const nextCell = document.querySelector(`[data-math_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_m1semester);
                                    const nextCell = document.querySelector(`[data-math_h_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_m1semester);
                                    const nextCell = document.querySelector(`[data-math_h_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_m1semester);
                                    const nextCell = document.querySelector(`[data-math_h_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_m1semester);
                                    const nextCell = document.querySelector(`[data-math_speak_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_m1semester);
                                    const nextCell = document.querySelector(`[data-math_speak_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_m1semester);
                                    const nextCell = document.querySelector(`[data-math_speak_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_m1semester = d.val().sci_m1semester;
                        var sci_h_m1semester = d.val().sci_h_m1semester;
                        if (!sci_m1semester) { sci_m1semester = 0 }
                        if (!sci_h_m1semester) { sci_h_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_m1semester1="${N0}">${sci_m1semester}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_m1semester="${N0}">${sci_h_m1semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_m1semester: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_m1semester1);
                                    const nextCell = document.querySelector(`[data-sci_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_m1semester1);
                                    const nextCell = document.querySelector(`[data-sci_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_m1semester1);
                                    const nextCell = document.querySelector(`[data-sci_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_m1semester);
                                    const nextCell = document.querySelector(`[data-sci_h_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_m1semester);
                                    const nextCell = document.querySelector(`[data-sci_h_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_m1semester);
                                    const nextCell = document.querySelector(`[data-sci_h_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_m1semester = d.val().soc_m1semester;
                        var soc_h_m1semester = d.val().soc_h_m1semester;
                        if (!soc_m1semester) { soc_m1semester = 0 }
                        if (!soc_h_m1semester) { soc_h_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_m1semester1="${N0}">${soc_m1semester}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_m1semester="${N0}">${soc_h_m1semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_m1semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_m1semester: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_m1semester1);
                                    const nextCell = document.querySelector(`[data-soc_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_m1semester1);
                                    const nextCell = document.querySelector(`[data-soc_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_m1semester1);
                                    const nextCell = document.querySelector(`[data-soc_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_m1semester);
                                    const nextCell = document.querySelector(`[data-soc_h_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_m1semester);
                                    const nextCell = document.querySelector(`[data-soc_h_m1semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_m1semester);
                                    const nextCell = document.querySelector(`[data-soc_h_m1semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_m1semester = d.val().geor_m1semester;
                        if (!geor_m1semester) { geor_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_m1semester1="${N0}">${geor_m1semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_m1semester: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m1semester1);
                                    const nextCell = document.querySelector(`[data-geor_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m1semester1);
                                    const nextCell = document.querySelector(`[data-geor_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m1semester1);
                                    const nextCell = document.querySelector(`[data-geor_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_m1semester = d.val().hist_m1semester;
                        if (!hist_m1semester) { hist_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_m1semester1="${N0}">${hist_m1semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_m1semester: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m1semester1);
                                    const nextCell = document.querySelector(`[data-hist_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m1semester1);
                                    const nextCell = document.querySelector(`[data-hist_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m1semester1);
                                    const nextCell = document.querySelector(`[data-hist_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_m1semester = d.val().moral_m1semester;
                        if (!moral_m1semester) { moral_m1semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_m1semester1="${N0}">${moral_m1semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_m1semester: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_m1semester1);
                                    const nextCell = document.querySelector(`[data-moral_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_m1semester1);
                                    const nextCell = document.querySelector(`[data-moral_m1semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_m1semester1);
                                    const nextCell = document.querySelector(`[data-moral_m1semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }



    }
    // ឆមាសទី២
    if (user_month == '2nd Semester') {
        //ភាសាអង់គ្លេស
        if (sb == 'E') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var e_m2semester = d.val().e_m2semester;
                        var e_h_m2semester = d.val().e_h_m2semester;
                        if (!e_m2semester) { e_m2semester = 0 }
                        if (!e_h_m2semester) { e_h_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}e" contenteditable onclick="selectText(this)" data-e_m2semester1="${N0}">${e_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}e_h" contenteditable onclick="selectText(this)" data-e_m2semester2="${N0}">${e_h_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}e`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}e_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}e_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        e_h_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester1);
                                    const nextCell = document.querySelector(`[data-e_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester1);
                                    const nextCell = document.querySelector(`[data-e_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester1);
                                    const nextCell = document.querySelector(`[data-e_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester2);
                                    const nextCell = document.querySelector(`[data-e_m2semester2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester2);
                                    const nextCell = document.querySelector(`[data-e_m2semester2="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.e_m2semester2);
                                    const nextCell = document.querySelector(`[data-e_m2semester2="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });


                        };
                        sleep(1000);
                    })
                })

        }
        //កីឡា
        if (sb == 'PE') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var pe_m2semester = d.val().pe_m2semester;
                        if (!pe_m2semester) { pe_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}pe" contenteditable onclick="selectText(this)" data-pe_m2semester1="${N0}">${pe_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}pe`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}pe`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        pe_m2semester: d,
                                    });
                            })

                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m2semester1);
                                    const nextCell = document.querySelector(`[data-pe_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m2semester1);
                                    const nextCell = document.querySelector(`[data-pe_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.pe_m2semester1);
                                    const nextCell = document.querySelector(`[data-pe_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភាសាខ្មែរ
        if (sb == 'K') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var k_listen_m2semester = d.val().k_listen_m2semester;
                        var k_speak_m2semester = d.val().k_speak_m2semester;
                        var k_reading_m2semester = d.val().k_reading_m2semester;
                        var k_dictation_m2semester = d.val().k_dictation_m2semester;
                        var k_writing_m2semester = d.val().k_writing_m2semester;
                        var k_grammar_m2semester = d.val().k_grammar_m2semester;
                        var k_homework_m2semester = d.val().k_homework_m2semester;
                        if (!k_listen_m2semester) { k_listen_m2semester = 0 }
                        if (!k_speak_m2semester) { k_speak_m2semester = 0 }
                        if (!k_reading_m2semester) { k_reading_m2semester = 0 }
                        if (!k_writing_m2semester) { k_writing_m2semester = 0 }
                        if (!k_homework_m2semester) { k_homework_m2semester = 0 }
                        if (!k_grammar_m2semester) { k_grammar_m2semester = 0 }
                        if (!k_dictation_m2semester) { k_dictation_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">ការស្តាប់</td>
                                    <td class="border-dark text-center">ការនិយាយ</td>
                                    <td class="border-dark text-center">អំណាន</td>
                                    <td class="border-dark text-center">សរសេរតាមអាន</td>
                                    <td class="border-dark text-center">តែងសេចក្តី</td>
                                    <td class="border-dark text-center">វេយ្យករណ៍</td>
                                    <td class="border-dark text-center">កិ.(ខ្មែរ)</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}k_listen" contenteditable onclick="selectText(this)" data-k_listen_m2semester="${N0}">${k_listen_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_speak" contenteditable onclick="selectText(this)" data-k_speak_m2semester="${N0}">${k_speak_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_reading" contenteditable onclick="selectText(this)" data-k_reading_m2semester="${N0}">${k_reading_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_dictation" contenteditable onclick="selectText(this)" data-k_dictation_m2semester="${N0}">${k_dictation_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_writing" contenteditable onclick="selectText(this)" data-k_writing_m2semester="${N0}">${k_writing_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_grammar" contenteditable onclick="selectText(this)" data-k_grammar_m2semester="${N0}">${k_grammar_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}k_homework" contenteditable onclick="selectText(this)" data-k_homework_m2semester="${N0}">${k_homework_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}k_listen`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_listen`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_listen_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_speak_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_reading`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_reading`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_reading_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_dictation`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_dictation`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_dictation_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_writing`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_writing`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_writing_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_homework`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_homework`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_homework_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}k_grammar`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}k_grammar`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        k_grammar_m2semester: d,
                                    });
                            })

                            //Enter Grammar
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_m2semester);
                                    const nextCell = document.querySelector(`[data-k_grammar_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_m2semester);
                                    const nextCell = document.querySelector(`[data-k_grammar_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_grammar_m2semester);
                                    const nextCell = document.querySelector(`[data-k_grammar_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 1
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_m2semester);
                                    const nextCell = document.querySelector(`[data-k_listen_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_m2semester);
                                    const nextCell = document.querySelector(`[data-k_listen_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_listen_m2semester);
                                    const nextCell = document.querySelector(`[data-k_listen_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                            //Enter 2
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_m2semester);
                                    const nextCell = document.querySelector(`[data-k_speak_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_m2semester);
                                    const nextCell = document.querySelector(`[data-k_speak_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_speak_m2semester);
                                    const nextCell = document.querySelector(`[data-k_speak_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 3
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_m2semester);
                                    const nextCell = document.querySelector(`[data-k_reading_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_m2semester);
                                    const nextCell = document.querySelector(`[data-k_reading_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_reading_m2semester);
                                    const nextCell = document.querySelector(`[data-k_reading_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 4
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_m2semester);
                                    const nextCell = document.querySelector(`[data-k_dictation_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_m2semester);
                                    const nextCell = document.querySelector(`[data-k_dictation_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_dictation_m2semester);
                                    const nextCell = document.querySelector(`[data-k_dictation_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 5
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_m2semester);
                                    const nextCell = document.querySelector(`[data-k_writing_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_m2semester);
                                    const nextCell = document.querySelector(`[data-k_writing_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_writing_m2semester);
                                    const nextCell = document.querySelector(`[data-k_writing_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Enter 6
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_m2semester);
                                    const nextCell = document.querySelector(`[data-k_homework_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_m2semester);
                                    const nextCell = document.querySelector(`[data-k_homework_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.k_homework_m2semester);
                                    const nextCell = document.querySelector(`[data-k_homework_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //គណិតវិទ្យា
        if (sb == 'M') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var math_m2semester = d.val().math_m2semester;
                        var math_h_m2semester = d.val().math_h_m2semester;
                        var math_speak_m2semester = d.val().math_speak_m2semester;
                        if (!math_m2semester) { math_m2semester = 0 }
                        if (!math_h_m2semester) { math_h_m2semester = 0 }
                        if (!math_speak_m2semester) { math_speak_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    <td class="border-dark text-center">គ.ផ្ទាល់មាត់</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}math" contenteditable onclick="selectText(this)" data-math_m2semester1="${N0}">${math_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}math_h" contenteditable onclick="selectText(this)" data-math_h_m2semester="${N0}">${math_h_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}math_speak" contenteditable onclick="selectText(this)" data-math_speak_m2semester="${N0}">${math_speak_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}math`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_h_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}math_speak`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}math_speak`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        math_speak_m2semester: d,
                                    });
                            })

                            //Math Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m2semester1);
                                    const nextCell = document.querySelector(`[data-math_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m2semester1);
                                    const nextCell = document.querySelector(`[data-math_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_m2semester1);
                                    const nextCell = document.querySelector(`[data-math_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_m2semester);
                                    const nextCell = document.querySelector(`[data-math_h_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_m2semester);
                                    const nextCell = document.querySelector(`[data-math_h_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_h_m2semester);
                                    const nextCell = document.querySelector(`[data-math_h_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Math Speaking
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_m2semester);
                                    const nextCell = document.querySelector(`[data-math_speak_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_m2semester);
                                    const nextCell = document.querySelector(`[data-math_speak_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.math_speak_m2semester);
                                    const nextCell = document.querySelector(`[data-math_speak_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //វិទ្យាសាស្ត្រ
        if (sb == 'Sci') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var sci_m2semester = d.val().sci_m2semester;
                        var sci_h_m2semester = d.val().sci_h_m2semester;
                        if (!sci_m2semester) { sci_m2semester = 0 }
                        if (!sci_h_m2semester) { sci_h_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                    <tr class="frezze">
                                    <td class="border-dark text-center">ល.រ</td>
                                    <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                    <td class="border-dark text-center">${sub}</td>
                                    <td class="border-dark text-center">កិ.(${sub})</td>
                                    </tr>
                                    
                                    `;
                        table.innerHTML = t;
                        let e = `
                                    <td class='border-dark text-center'>${N0}</td>
                                    <td class='border-dark text-start'>${id}</td>
                                    <td class='border-dark text-center' id="${no_space}sci" contenteditable onclick="selectText(this)" data-sci_m2semester1="${N0}">${sci_m2semester}</td>
                                    <td class='border-dark text-center' id="${no_space}sci_h" contenteditable onclick="selectText(this)" data-sci_h_m2semester="${N0}">${sci_h_m2semester}</td>
                                    `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}sci`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}sci_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}sci_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        sci_h_m2semester: d,
                                    });
                            })

                            //sci Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_m2semester1);
                                    const nextCell = document.querySelector(`[data-sci_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_m2semester1);
                                    const nextCell = document.querySelector(`[data-sci_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_m2semester1);
                                    const nextCell = document.querySelector(`[data-sci_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_m2semester);
                                    const nextCell = document.querySelector(`[data-sci_h_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_m2semester);
                                    const nextCell = document.querySelector(`[data-sci_h_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.sci_h_m2semester);
                                    const nextCell = document.querySelector(`[data-sci_h_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //សិក្សាសង្គម
        if (sb == 'Soc') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var soc_m2semester = d.val().soc_m2semester;
                        var soc_h_m2semester = d.val().soc_h_m2semester;
                        if (!soc_m2semester) { soc_m2semester = 0 }
                        if (!soc_h_m2semester) { soc_h_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            <td class="border-dark text-center">កិ.(${sub})</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}soc" contenteditable onclick="selectText(this)" data-soc_m2semester1="${N0}">${soc_m2semester}</td>
                                            <td class='border-dark text-center' id="${no_space}soc_h" contenteditable onclick="selectText(this)" data-soc_h_m2semester="${N0}">${soc_h_m2semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}soc`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_m2semester: d,
                                    });
                            })
                            document.getElementById(`${no_space}soc_h`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}soc_h`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        soc_h_m2semester: d,
                                    });
                            })

                            //soc Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_m2semester1);
                                    const nextCell = document.querySelector(`[data-soc_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_m2semester1);
                                    const nextCell = document.querySelector(`[data-soc_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_m2semester1);
                                    const nextCell = document.querySelector(`[data-soc_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            //Homework
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_m2semester);
                                    const nextCell = document.querySelector(`[data-soc_h_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_m2semester);
                                    const nextCell = document.querySelector(`[data-soc_h_m2semester="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.soc_h_m2semester);
                                    const nextCell = document.querySelector(`[data-soc_h_m2semester="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                        };
                        sleep(1000);
                    })
                })

        }
        //ភូមិវិទ្យា
        if (sb == 'G') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var geor_m2semester = d.val().geor_m2semester;
                        if (!geor_m2semester) { geor_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}geor" contenteditable onclick="selectText(this)" data-geor_m2semester1="${N0}">${geor_m2semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}geor`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}geor`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        geor_m2semester: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m2semester1);
                                    const nextCell = document.querySelector(`[data-geor_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m2semester1);
                                    const nextCell = document.querySelector(`[data-geor_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.geor_m2semester1);
                                    const nextCell = document.querySelector(`[data-geor_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ប្រវត្តិវិទ្យា
        if (sb == 'H') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var hist_m2semester = d.val().hist_m2semester;
                        if (!hist_m2semester) { hist_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}hist" contenteditable onclick="selectText(this)" data-hist_m2semester1="${N0}">${hist_m2semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}hist`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}hist`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        hist_m2semester: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m2semester1);
                                    const nextCell = document.querySelector(`[data-hist_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m2semester1);
                                    const nextCell = document.querySelector(`[data-hist_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.hist_m2semester1);
                                    const nextCell = document.querySelector(`[data-hist_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }
        //ពលរដ្ឋ
        if (sb == 'Mo') {
            firebase
                .database()
                .ref(`/SalaMOM/classes/` + `${user_login_year}/` + grade)
                .once('value', function (data) {
                    data.forEach(function (d) {
                        var id = d.val().id;
                        var name = d.val().name;
                        var moral_m2semester = d.val().moral_m2semester;
                        if (!moral_m2semester) { moral_m2semester = 0 }
                        var no_space = id.replace(/\s/g, "");
                        N0++;
                        let t = `
                                            <tr class="frezze">
                                            <td class="border-dark text-center">ល.រ</td>
                                            <td class="border-dark text-center">ឈ្មោះពេញ</td>
                                            <td class="border-dark text-center">${sub}</td>
                                            </tr>
                                            `;
                        table.innerHTML = t;
                        let e = `
                                            <td class='border-dark text-center'>${N0}</td>
                                            <td class='border-dark text-start'>${id}</td>
                                            <td class='border-dark text-center' id="${no_space}moral" contenteditable onclick="selectText(this)" data-moral_m2semester1="${N0}">${moral_m2semester}</td>
                                            `;
                        tbody_data.innerHTML += e;
                        const sleep = async (milliseconds) => {
                            await new Promise((resolve) => {
                                return setTimeout(resolve, milliseconds);
                            });
                            document.getElementById(`${no_space}moral`).addEventListener('input', () => {
                                var d = document.getElementById(`${no_space}moral`).innerHTML;
                                firebase
                                    .database()
                                    .ref(`SalaMOM/classes/` + `${user_login_year}/` + `${grade}/` + id)
                                    .update({
                                        moral_m2semester: d,
                                    });
                            })

                            //G Score
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "Enter") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_m2semester1);
                                    const nextCell = document.querySelector(`[data-moral_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowDown") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_m2semester1);
                                    const nextCell = document.querySelector(`[data-moral_m2semester1="${currentIndex + 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });
                            document.getElementById('showData').addEventListener("keydown", (event) => {
                                if (event.key === "ArrowUp") {
                                    event.preventDefault();
                                    const currentCell = event.target;
                                    const currentIndex = parseInt(currentCell.dataset.moral_m2semester1);
                                    const nextCell = document.querySelector(`[data-moral_m2semester1="${currentIndex - 1}"]`);
                                    const focusedCell = document.activeElement;
                                    if (focusedCell && focusedCell.tagName === "TD") {
                                        const text = focusedCell.textContent;
                                        const range = document.createRange();
                                        range.selectNodeContents(focusedCell);
                                        const selection = window.getSelection();
                                        selection.removeAllRanges();
                                        selection.addRange(range);
                                    }
                                    if (nextCell) {
                                        nextCell.focus();
                                        if (nextCell.textContent == 0) {
                                            nextCell.textContent = '';
                                        }
                                    }
                                }
                            });

                        };
                        sleep(1000);
                    })
                })

        }

    }
}